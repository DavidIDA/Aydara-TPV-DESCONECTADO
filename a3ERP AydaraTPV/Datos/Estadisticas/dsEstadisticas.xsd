<?xml version="1.0" encoding="utf-8"?>
<xs:schema id="dsEstadisticas" targetNamespace="http://tempuri.org/dsEstadisticas.xsd" xmlns:mstns="http://tempuri.org/dsEstadisticas.xsd" xmlns="http://tempuri.org/dsEstadisticas.xsd" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata" xmlns:msprop="urn:schemas-microsoft-com:xml-msprop" attributeFormDefault="qualified" elementFormDefault="qualified">
  <xs:annotation>
    <xs:appinfo source="urn:schemas-microsoft-com:xml-msdatasource">
      <DataSource DefaultConnectionIndex="0" FunctionsComponentName="QueriesTableAdapter" Modifier="AutoLayout, AnsiClass, Class, Public" SchemaSerializationMode="IncludeSchema" xmlns="urn:schemas-microsoft-com:xml-msdatasource">
        <Connections>
          <Connection AppSettingsObjectName="Settings" AppSettingsPropertyName="SqlConection" ConnectionStringObject="" IsAppSettingsProperty="true" Modifier="Assembly" Name="SqlConection (Settings)" ParameterPrefix="@" PropertyReference="ApplicationSettings.a3ERP_AydaraTPV.Settings.GlobalReference.Default.SqlConection" Provider="System.Data.SqlClient" />
        </Connections>
        <Tables>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="VENTASTableAdapter" GeneratorDataComponentClassName="VENTASTableAdapter" Name="VENTAS" UserDataComponentName="VENTASTableAdapter">
            <MainSource>
              <DbSource ConnectionRef="SqlConection (Settings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Fill" GenerateShortCommands="false" GeneratorSourceName="Fill" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        YEAR(FECHA) AS EJERCICIO, MONTH(FECHA) AS MES, SUM(VENTA_CONTADO) AS VENTA_CONTADO, SUM(VENTA_CREDITO) VENTA_CREDITO, SUM(UNIDADES * COSTE_CONTADO) AS COSTE_CONTADO, SUM(UNIDADES * COSTE_CREDITO) AS COSTE_CREDITO
FROM            (
SELECT        CABEFACV.FECHA, TIPOCONT, SERIE, CODCLI, LINEFACT.CODREP, LINEFACT.CODALM, 0 VENTA_CONTADO, LINEFACT.BASE VENTA_CREDITO, LINEFACT.UNIDADES, 0 COSTE_CONTADO, LINEFACT.PRCMEDIO COSTE_CREDITO
FROM            CABEFACV INNER JOIN LINEFACT ON CABEFACV.IDFACV = LINEFACT.IDFACV
WHERE CONTABLE='F'
UNION ALL
SELECT        CABEALBV.FECHA, TIPOCONT, SERIE, CODCLI, LINEALBA.CODREP, LINEALBA.CODALM, CASE FACTURABLE WHEN 'T' THEN 0 ELSE LINEALBA.BASE END VENTA_CONTADO, CASE FACTURABLE WHEN 'T' THEN LINEALBA.BASE ELSE 0 END VENTA_CREDITO, LINEALBA.UNIDADES, CASE FACTURABLE WHEN 'T' THEN 0 ELSE LINEALBA.PRCMEDIO END COSTE_CONTADO, CASE FACTURABLE WHEN 'T' THEN LINEALBA.PRCMEDIO ELSE 0 END COSTE_CREDITO
FROM            CABEALBV INNER JOIN LINEALBA ON CABEALBV.IDALBV = LINEALBA.IDALBV
WHERE LINEALBA.SITUACION='A'
) AS VENTAS
GROUP BY YEAR(FECHA), MONTH(FECHA)</CommandText>
                    <Parameters />
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="EJERCICIO" DataSetColumn="EJERCICIO" />
              <Mapping SourceColumn="MES" DataSetColumn="MES" />
              <Mapping SourceColumn="VENTA_CONTADO" DataSetColumn="VENTA_CONTADO" />
              <Mapping SourceColumn="COSTE_CONTADO" DataSetColumn="COSTE_CONTADO" />
              <Mapping SourceColumn="COSTE_CREDITO" DataSetColumn="COSTE_CREDITO" />
              <Mapping SourceColumn="VENTA_CREDITO" DataSetColumn="VENTA_CREDITO" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="SqlConection (Settings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Almacen" GenerateMethods="Fill" GenerateShortCommands="true" GeneratorSourceName="Almacen" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataBy" UserSourceName="Almacen">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        YEAR(FECHA) AS EJERCICIO, MONTH(FECHA) AS MES, SUM(VENTA_CONTADO) AS VENTA_CONTADO, SUM(VENTA_CREDITO) VENTA_CREDITO, SUM(UNI_CONTADO * PRCMEDIO) AS COSTE_CONTADO, SUM(UNI_CREDITO * PRCMEDIO) AS COSTE_CREDITO, SUM(COMPRA) AS COMPRA, SUM(UNI_CONTADO) UNI_CONTADO, SUM(UNI_CREDITO) UNI_CREDITO, SUM(UNI_COMPRA) AS UNI_COMPRA
FROM            (
SELECT        CABEFACV.FECHA, LINEFACT.CODALM, 0 UNI_CONTADO, 0 VENTA_CONTADO, LINEFACT.UNIDADES UNI_CREDITO, LINEFACT.BASE VENTA_CREDITO, LINEFACT.PRCMEDIO, 0 AS UNI_COMPRA, 0 AS COMPRA
FROM            CABEFACV INNER JOIN LINEFACT ON CABEFACV.IDFACV = LINEFACT.IDFACV
WHERE CONTABLE='F'
UNION ALL
SELECT        CABEALBV.FECHA, LINEALBA.CODALM, CASE FACTURABLE WHEN 'T' THEN 0 ELSE LINEALBA.UNIDADES END UNI_CONTADO, CASE FACTURABLE WHEN 'T' THEN 0 ELSE LINEALBA.BASE END VENTA_CONTADO, CASE FACTURABLE WHEN 'T' THEN LINEALBA.UNIDADES ELSE 0 END UNI_CREDITO, CASE FACTURABLE WHEN 'T' THEN LINEALBA.BASE ELSE 0 END VENTA_CREDITO, LINEALBA.PRCMEDIO, 0AS UNI_COMPRA, 0 AS COMPRA
FROM            CABEALBV INNER JOIN LINEALBA ON CABEALBV.IDALBV = LINEALBA.IDALBV
WHERE CABEALBV.SITUACION='A'
UNION ALL
SELECT        CABEALBC.FECHA, LINEALBA.CODALM, 0 UNI_CONTADO, 0 VENTA_CONTADO, 0 UNI_CREDITO, 0 VENTA_CREDITO, 0 PRCMEDIO, LINEALBA.UNIDADES AS UNI_COMPRA, LINEALBA.BASE AS COMPRA
FROM            CABEALBC INNER JOIN LINEALBA ON CABEALBC.IDALBC = LINEALBA.IDALBC
WHERE  CABEALBC.SITUACION = 'A'
UNION ALL
SELECT        CABEFACC.FECHA, LINEFACT.CODALM, 0 UNI_CONTADO, 0 VENTA_CONTADO, 0 UNI_CREDITO, 0 VENTA_CREDITO, 0 PRCMEDIO, LINEFACT.UNIDADES AS UNI_COMPRA, LINEFACT.BASE AS COMPRA
FROM            CABEFACC INNER JOIN LINEFACT ON CABEFACC.IDFACC = LINEFACT.IDFACC
WHERE CONTABLE = 'F'
) AS VENTAS
WHERE  CODALM = @CODALM
GROUP BY YEAR(FECHA), MONTH(FECHA)</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="CODALM" ColumnName="CODALM" DataSourceName="SELECT CABEFACV.FECHA, LINEFACT.CODALM, 0 UNI_CONTADO, 0 VENTA_CONTADO, LINEFACT.UNIDADES UNI_CREDITO, LINEFACT.BASE VENTA_CREDITO, LINEFACT.PRCMEDIO, 0 AS UNI_COMPRA, 0 AS COMPRA FROM CABEFACV INNER JOIN LINEFACT ON CABEFACV.IDFACV = LINEFACT.IDFACV WHERE CONTABLE='F' UNION ALL SELECT CABEALBV.FECHA, LINEALBA.CODALM, CASE FACTURABLE WHEN 'T' THEN 0 ELSE LINEALBA.UNIDADES END UNI_CONTADO, CASE FACTURABLE WHEN 'T' THEN 0 ELSE LINEALBA.BASE END VENTA_CONTADO, CASE FACTURABLE WHEN 'T' THEN LINEALBA.UNIDADES ELSE 0 END UNI_CREDITO, CASE FACTURABLE WHEN 'T' THEN LINEALBA.BASE ELSE 0 END VENTA_CREDITO, LINEALBA.PRCMEDIO, 0AS UNI_COMPRA, 0 AS COMPRA FROM CABEALBV INNER JOIN LINEALBA ON CABEALBV.IDALBV = LINEALBA.IDALBV WHERE CABEALBV.SITUACION='A' UNION ALL SELECT CABEALBC.FECHA, LINEALBA.CODALM, 0 UNI_CONTADO, 0 VENTA_CONTADO, 0 UNI_CREDITO, 0 VENTA_CREDITO, 0 PRCMEDIO, LINEALBA.UNIDADES AS UNI_COMPRA, LINEALBA.BASE AS COMPRA FROM CABEALBC INNER JOIN LINEALBA ON CABEALBC.IDALBC = LINEALBA.IDALBC WHERE CABEALBC.SITUACION = 'A' UNION ALL SELECT CABEFACC.FECHA, LINEFACT.CODALM, 0 UNI_CONTADO, 0 VENTA_CONTADO, 0 UNI_CREDITO, 0 VENTA_CREDITO, 0 PRCMEDIO, LINEFACT.UNIDADES AS UNI_COMPRA, LINEFACT.BASE AS COMPRA FROM CABEFACC INNER JOIN LINEFACT ON CABEFACC.IDFACC = LINEFACT.IDFACC WHERE CONTABLE = 'F'" DataTypeServer="varchar(8)" DbType="AnsiString" Direction="Input" ParameterName="@CODALM" Precision="0" Scale="0" Size="8" SourceColumn="CODALM" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="SqlConection (Settings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Artículo" GenerateMethods="Fill" GenerateShortCommands="true" GeneratorSourceName="Artículo" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataBy1" UserSourceName="Artículo">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        YEAR(FECHA) AS EJERCICIO, MONTH(FECHA) AS MES, SUM(VENTA_CONTADO) AS VENTA_CONTADO, SUM(VENTA_CREDITO) VENTA_CREDITO, SUM(UNI_CONTADO * PRCMEDIO) AS COSTE_CONTADO, SUM(UNI_CREDITO * PRCMEDIO) AS COSTE_CREDITO, SUM(COMPRA) AS COMPRA, SUM(UNI_CONTADO) UNI_CONTADO, SUM(UNI_CREDITO) UNI_CREDITO, SUM(UNI_COMPRA) AS UNI_COMPRA
FROM            (
SELECT        CABEFACV.FECHA, LINEFACT.CODALM, LINEFACT.CODART, 0 UNI_CONTADO, 0 VENTA_CONTADO, LINEFACT.UNIDADES UNI_CREDITO, LINEFACT.BASE VENTA_CREDITO, LINEFACT.PRCMEDIO, 0 UNI_COMPRA, 0 AS COMPRA
FROM            CABEFACV INNER JOIN LINEFACT ON CABEFACV.IDFACV = LINEFACT.IDFACV
WHERE CONTABLE='F'
UNION ALL
SELECT        CABEALBV.FECHA, LINEALBA.CODALM, LINEALBA.CODART, CASE FACTURABLE WHEN 'T' THEN 0 ELSE LINEALBA.UNIDADES END UNI_CONTADO, CASE FACTURABLE WHEN 'T' THEN 0 ELSE LINEALBA.BASE END VENTA_CONTADO, CASE FACTURABLE WHEN 'T' THEN LINEALBA.UNIDADES ELSE 0 END UNI_CREDITO, CASE FACTURABLE WHEN 'T' THEN LINEALBA.BASE ELSE 0 END VENTA_CREDITO, LINEALBA.PRCMEDIO, 0 AS UNI_COMPRA, 0 AS COMPRA
FROM            CABEALBV INNER JOIN LINEALBA ON CABEALBV.IDALBV = LINEALBA.IDALBV
WHERE CABEALBV.SITUACION='A'
UNION ALL
SELECT        CABEALBC.FECHA, LINEALBA.CODALM, LINEALBA.CODART, 0 UNI_CONTADO, 0 VENTA_CONTADO, 0 UNI_CREDITO, 0 VENTA_CREDITO, 0 PRCMEDIO, LINEALBA.UNIDADES AS UNI_COMPRA, LINEALBA.BASE AS COMPRA
FROM            CABEALBC INNER JOIN LINEALBA ON CABEALBC.IDALBC = LINEALBA.IDALBC
WHERE CABEALBC.SITUACION='A'
UNION ALL
SELECT        CABEFACC.FECHA, LINEFACT.CODALM, LINEFACT.CODART, 0 UNI_CONTADO, 0 VENTA_CONTADO, 0 UNI_CREDITO, 0 VENTA_CREDITO, 0 PRCMEDIO, LINEFACT.UNIDADES AS UNI_COMPRA, LINEFACT.BASE AS COMPRA
FROM            CABEFACC INNER JOIN LINEFACT ON CABEFACC.IDFACC = LINEFACT.IDFACC
WHERE CONTABLE = 'F'
) AS VENTAS
WHERE CODART = @CODART AND (CODALM = @CODALM OR
                         @CODALM = '')
GROUP BY YEAR(FECHA), MONTH(FECHA)</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="CODART" ColumnName="CODART" DataSourceName="SELECT CABEFACV.FECHA, LINEFACT.CODALM, LINEFACT.CODART, 0 UNI_CONTADO, 0 VENTA_CONTADO, LINEFACT.UNIDADES UNI_CREDITO, LINEFACT.BASE VENTA_CREDITO, LINEFACT.PRCMEDIO, 0 UNI_COMPRA, 0 AS COMPRA FROM CABEFACV INNER JOIN LINEFACT ON CABEFACV.IDFACV = LINEFACT.IDFACV WHERE CONTABLE='F' UNION ALL SELECT CABEALBV.FECHA, LINEALBA.CODALM, LINEALBA.CODART, CASE FACTURABLE WHEN 'T' THEN 0 ELSE LINEALBA.UNIDADES END UNI_CONTADO, CASE FACTURABLE WHEN 'T' THEN 0 ELSE LINEALBA.BASE END VENTA_CONTADO, CASE FACTURABLE WHEN 'T' THEN LINEALBA.UNIDADES ELSE 0 END UNI_CREDITO, CASE FACTURABLE WHEN 'T' THEN LINEALBA.BASE ELSE 0 END VENTA_CREDITO, LINEALBA.PRCMEDIO, 0 AS UNI_COMPRA, 0 AS COMPRA FROM CABEALBV INNER JOIN LINEALBA ON CABEALBV.IDALBV = LINEALBA.IDALBV WHERE CABEALBV.SITUACION='A' UNION ALL SELECT CABEALBC.FECHA, LINEALBA.CODALM, LINEALBA.CODART, 0 UNI_CONTADO, 0 VENTA_CONTADO, 0 UNI_CREDITO, 0 VENTA_CREDITO, 0 PRCMEDIO, LINEALBA.UNIDADES AS UNI_COMPRA, LINEALBA.BASE AS COMPRA FROM CABEALBC INNER JOIN LINEALBA ON CABEALBC.IDALBC = LINEALBA.IDALBC WHERE CABEALBC.SITUACION='A' UNION ALL SELECT CABEFACC.FECHA, LINEFACT.CODALM, LINEFACT.CODART, 0 UNI_CONTADO, 0 VENTA_CONTADO, 0 UNI_CREDITO, 0 VENTA_CREDITO, 0 PRCMEDIO, LINEFACT.UNIDADES AS UNI_COMPRA, LINEFACT.BASE AS COMPRA FROM CABEFACC INNER JOIN LINEFACT ON CABEFACC.IDFACC = LINEFACT.IDFACC WHERE CONTABLE = 'F'" DataTypeServer="varchar(15)" DbType="AnsiString" Direction="Input" ParameterName="@CODART" Precision="0" Scale="0" Size="15" SourceColumn="CODART" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="CODALM" ColumnName="CODALM" DataSourceName="SELECT CABEFACV.FECHA, LINEFACT.CODALM, LINEFACT.CODART, 0 UNI_CONTADO, 0 VENTA_CONTADO, LINEFACT.UNIDADES UNI_CREDITO, LINEFACT.BASE VENTA_CREDITO, LINEFACT.PRCMEDIO, 0 UNI_COMPRA, 0 AS COMPRA FROM CABEFACV INNER JOIN LINEFACT ON CABEFACV.IDFACV = LINEFACT.IDFACV WHERE CONTABLE='F' UNION ALL SELECT CABEALBV.FECHA, LINEALBA.CODALM, LINEALBA.CODART, CASE FACTURABLE WHEN 'T' THEN 0 ELSE LINEALBA.UNIDADES END UNI_CONTADO, CASE FACTURABLE WHEN 'T' THEN 0 ELSE LINEALBA.BASE END VENTA_CONTADO, CASE FACTURABLE WHEN 'T' THEN LINEALBA.UNIDADES ELSE 0 END UNI_CREDITO, CASE FACTURABLE WHEN 'T' THEN LINEALBA.BASE ELSE 0 END VENTA_CREDITO, LINEALBA.PRCMEDIO, 0 AS UNI_COMPRA, 0 AS COMPRA FROM CABEALBV INNER JOIN LINEALBA ON CABEALBV.IDALBV = LINEALBA.IDALBV WHERE CABEALBV.SITUACION='A' UNION ALL SELECT CABEALBC.FECHA, LINEALBA.CODALM, LINEALBA.CODART, 0 UNI_CONTADO, 0 VENTA_CONTADO, 0 UNI_CREDITO, 0 VENTA_CREDITO, 0 PRCMEDIO, LINEALBA.UNIDADES AS UNI_COMPRA, LINEALBA.BASE AS COMPRA FROM CABEALBC INNER JOIN LINEALBA ON CABEALBC.IDALBC = LINEALBA.IDALBC WHERE CABEALBC.SITUACION='A' UNION ALL SELECT CABEFACC.FECHA, LINEFACT.CODALM, LINEFACT.CODART, 0 UNI_CONTADO, 0 VENTA_CONTADO, 0 UNI_CREDITO, 0 VENTA_CREDITO, 0 PRCMEDIO, LINEFACT.UNIDADES AS UNI_COMPRA, LINEFACT.BASE AS COMPRA FROM CABEFACC INNER JOIN LINEFACT ON CABEFACC.IDFACC = LINEFACT.IDFACC WHERE CONTABLE = 'F'" DataTypeServer="varchar(8)" DbType="AnsiString" Direction="Input" ParameterName="@CODALM" Precision="0" Scale="0" Size="8" SourceColumn="CODALM" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="SqlConection (Settings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="ArtículoAMM" GenerateMethods="Fill" GenerateShortCommands="true" GeneratorSourceName="ArtículoAMM" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataBy2" UserSourceName="ArtículoAMM">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        YEAR(FECHA) AS EJERCICIO, MONTH(FECHA) AS MES, SUM(VENTA_CONTADO) AS VENTA_CONTADO, SUM(VENTA_CREDITO) AS VENTA_CREDITO, 
                         SUM(UNI_CONTADO * PRCMEDIO) AS COSTE_CONTADO, SUM(UNI_CREDITO * PRCMEDIO) AS COSTE_CREDITO, SUM(COMPRA) AS COMPRA, SUM(UNI_CONTADO) 
                         AS UNI_CONTADO, SUM(UNI_CREDITO) AS UNI_CREDITO, SUM(UNI_COMPRA) AS UNI_COMPRA
FROM            (SELECT        CABEFACV.FECHA, LINEFACT.CODALM, LINEFACT.CODART, 0 AS UNI_CONTADO, 0 AS VENTA_CONTADO, LINEFACT.UNIDADES AS UNI_CREDITO, 
                                                    LINEFACT.BASE AS VENTA_CREDITO, LINEFACT.PRCMEDIO, 0 AS UNI_COMPRA, 0 AS COMPRA
                          FROM            CABEFACV INNER JOIN
                                                    LINEFACT ON CABEFACV.IDFACV = LINEFACT.IDFACV
                          WHERE        (CABEFACV.CONTABLE = 'F') AND (LTRIM(CABEFACV.SERIE) &lt;&gt; '6')
                          UNION ALL
                          SELECT        CABEALBV.FECHA, LINEALBA.CODALM, LINEALBA.CODART, CASE FACTURABLE WHEN 'T' THEN 0 ELSE LINEALBA.UNIDADES END AS UNI_CONTADO, 
                                                   CASE FACTURABLE WHEN 'T' THEN 0 ELSE LINEALBA.BASE END AS VENTA_CONTADO, 
                                                   CASE FACTURABLE WHEN 'T' THEN LINEALBA.UNIDADES ELSE 0 END AS UNI_CREDITO, 
                                                   CASE FACTURABLE WHEN 'T' THEN LINEALBA.BASE ELSE 0 END AS VENTA_CREDITO, LINEALBA.PRCMEDIO, 0 AS UNI_COMPRA, 0 AS COMPRA
                          FROM            CABEALBV INNER JOIN
                                                   LINEALBA ON CABEALBV.IDALBV = LINEALBA.IDALBV
                          WHERE        (CABEALBV.SITUACION = 'A') AND (LTRIM(CABEALBV.SERIE) &lt;&gt; '6')
                          UNION ALL
                          SELECT        CABEALBC.FECHA, LINEALBA.CODALM, LINEALBA.CODART, 0 AS UNI_CONTADO, 0 AS VENTA_CONTADO, 0 AS UNI_CREDITO, 
                                                   0 AS VENTA_CREDITO, 0 AS PRCMEDIO, LINEALBA.UNIDADES AS UNI_COMPRA, LINEALBA.BASE AS COMPRA
                          FROM            CABEALBC INNER JOIN
                                                   LINEALBA ON CABEALBC.IDALBC = LINEALBA.IDALBC
                          WHERE        CABEALBC.SITUACION='A' AND (LTRIM(CABEALBC.CODPRO) &lt;&gt; '911')
                         UNION ALL
                         SELECT        CABEFACC.FECHA, LINEFACT.CODALM, LINEFACT.CODART, 0 UNI_CONTADO, 0 VENTA_CONTADO, 0 UNI_CREDITO, 0 VENTA_CREDITO, 0 PRCMEDIO, LINEFACT.UNIDADES AS UNI_COMPRA, LINEFACT.BASE AS COMPRA
                         FROM            CABEFACC INNER JOIN LINEFACT ON CABEFACC.IDFACC = LINEFACT.IDFACC
                         WHERE CONTABLE = 'F' AND (LTRIM(CABEFACC.CODPRO) &lt;&gt; '911')
) AS VENTAS
WHERE        (CODART = @CODART) AND (CODALM = @CODALM OR
                         @CODALM = '')
GROUP BY YEAR(FECHA), MONTH(FECHA)</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="CODART" ColumnName="CODART" DataSourceName="SELECT CABEFACV.FECHA, LINEFACT.CODALM, LINEFACT.CODART, 0 AS UNI_CONTADO, 0 AS VENTA_CONTADO, LINEFACT.UNIDADES AS UNI_CREDITO, LINEFACT.BASE AS VENTA_CREDITO, LINEFACT.PRCMEDIO, 0 AS UNI_COMPRA, 0 AS COMPRA FROM CABEFACV INNER JOIN LINEFACT ON CABEFACV.IDFACV = LINEFACT.IDFACV WHERE (CABEFACV.CONTABLE = 'F') AND (LTRIM(CABEFACV.SERIE) &lt;&gt; '6') UNION ALL SELECT CABEALBV.FECHA, LINEALBA.CODALM, LINEALBA.CODART, CASE FACTURABLE WHEN 'T' THEN 0 ELSE LINEALBA.UNIDADES END AS UNI_CONTADO, CASE FACTURABLE WHEN 'T' THEN 0 ELSE LINEALBA.BASE END AS VENTA_CONTADO, CASE FACTURABLE WHEN 'T' THEN LINEALBA.UNIDADES ELSE 0 END AS UNI_CREDITO, CASE FACTURABLE WHEN 'T' THEN LINEALBA.BASE ELSE 0 END AS VENTA_CREDITO, LINEALBA.PRCMEDIO, 0 AS UNI_COMPRA, 0 AS COMPRA FROM CABEALBV INNER JOIN LINEALBA ON CABEALBV.IDALBV = LINEALBA.IDALBV WHERE (CABEALBV.SITUACION = 'A') AND (LTRIM(CABEALBV.SERIE) &lt;&gt; '6') UNION ALL SELECT CABEALBC.FECHA, LINEALBA.CODALM, LINEALBA.CODART, 0 AS UNI_CONTADO, 0 AS VENTA_CONTADO, 0 AS UNI_CREDITO, 0 AS VENTA_CREDITO, 0 AS PRCMEDIO, LINEALBA.UNIDADES AS UNI_COMPRA, LINEALBA.BASE AS COMPRA FROM CABEALBC INNER JOIN LINEALBA ON CABEALBC.IDALBC = LINEALBA.IDALBC WHERE CABEALBC.SITUACION='A' AND (LTRIM(CABEALBC.CODPRO) &lt;&gt; '911') UNION ALL SELECT CABEFACC.FECHA, LINEFACT.CODALM, LINEFACT.CODART, 0 UNI_CONTADO, 0 VENTA_CONTADO, 0 UNI_CREDITO, 0 VENTA_CREDITO, 0 PRCMEDIO, LINEFACT.UNIDADES AS UNI_COMPRA, LINEFACT.BASE AS COMPRA FROM CABEFACC INNER JOIN LINEFACT ON CABEFACC.IDFACC = LINEFACT.IDFACC WHERE CONTABLE = 'F' AND (LTRIM(CABEFACC.CODPRO) &lt;&gt; '911')" DataTypeServer="varchar(15)" DbType="AnsiString" Direction="Input" ParameterName="@CODART" Precision="0" Scale="0" Size="15" SourceColumn="CODART" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="CODALM" ColumnName="CODALM" DataSourceName="SELECT CABEFACV.FECHA, LINEFACT.CODALM, LINEFACT.CODART, 0 AS UNI_CONTADO, 0 AS VENTA_CONTADO, LINEFACT.UNIDADES AS UNI_CREDITO, LINEFACT.BASE AS VENTA_CREDITO, LINEFACT.PRCMEDIO, 0 AS UNI_COMPRA, 0 AS COMPRA FROM CABEFACV INNER JOIN LINEFACT ON CABEFACV.IDFACV = LINEFACT.IDFACV WHERE (CABEFACV.CONTABLE = 'F') AND (LTRIM(CABEFACV.SERIE) &lt;&gt; '6') UNION ALL SELECT CABEALBV.FECHA, LINEALBA.CODALM, LINEALBA.CODART, CASE FACTURABLE WHEN 'T' THEN 0 ELSE LINEALBA.UNIDADES END AS UNI_CONTADO, CASE FACTURABLE WHEN 'T' THEN 0 ELSE LINEALBA.BASE END AS VENTA_CONTADO, CASE FACTURABLE WHEN 'T' THEN LINEALBA.UNIDADES ELSE 0 END AS UNI_CREDITO, CASE FACTURABLE WHEN 'T' THEN LINEALBA.BASE ELSE 0 END AS VENTA_CREDITO, LINEALBA.PRCMEDIO, 0 AS UNI_COMPRA, 0 AS COMPRA FROM CABEALBV INNER JOIN LINEALBA ON CABEALBV.IDALBV = LINEALBA.IDALBV WHERE (CABEALBV.SITUACION = 'A') AND (LTRIM(CABEALBV.SERIE) &lt;&gt; '6') UNION ALL SELECT CABEALBC.FECHA, LINEALBA.CODALM, LINEALBA.CODART, 0 AS UNI_CONTADO, 0 AS VENTA_CONTADO, 0 AS UNI_CREDITO, 0 AS VENTA_CREDITO, 0 AS PRCMEDIO, LINEALBA.UNIDADES AS UNI_COMPRA, LINEALBA.BASE AS COMPRA FROM CABEALBC INNER JOIN LINEALBA ON CABEALBC.IDALBC = LINEALBA.IDALBC WHERE CABEALBC.SITUACION='A' AND (LTRIM(CABEALBC.CODPRO) &lt;&gt; '911') UNION ALL SELECT CABEFACC.FECHA, LINEFACT.CODALM, LINEFACT.CODART, 0 UNI_CONTADO, 0 VENTA_CONTADO, 0 UNI_CREDITO, 0 VENTA_CREDITO, 0 PRCMEDIO, LINEFACT.UNIDADES AS UNI_COMPRA, LINEFACT.BASE AS COMPRA FROM CABEFACC INNER JOIN LINEFACT ON CABEFACC.IDFACC = LINEFACT.IDFACC WHERE CONTABLE = 'F' AND (LTRIM(CABEFACC.CODPRO) &lt;&gt; '911')" DataTypeServer="varchar(8)" DbType="AnsiString" Direction="Input" ParameterName="@CODALM" Precision="0" Scale="0" Size="8" SourceColumn="CODALM" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="SqlConection (Settings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Cliente" GenerateMethods="Fill" GenerateShortCommands="true" GeneratorSourceName="Cliente" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataBy3" UserSourceName="Cliente">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        YEAR(FECHA) AS EJERCICIO, MONTH(FECHA) AS MES, SUM(VENTA_CONTADO) AS VENTA_CONTADO, SUM(VENTA_CREDITO) VENTA_CREDITO, SUM(UNI_CONTADO * PRCMEDIO) AS COSTE_CONTADO, SUM(UNI_CREDITO * PRCMEDIO) AS COSTE_CREDITO, 0 AS COMPRA, SUM(UNI_CONTADO) UNI_CONTADO, SUM(UNI_CREDITO) UNI_CREDITO
FROM            (
SELECT        TIPOCONT, CABEFACV.FECHA, CABEFACV.CODCLI, 0 UNI_CONTADO, 0 VENTA_CONTADO, LINEFACT.UNIDADES UNI_CREDITO, LINEFACT.BASE VENTA_CREDITO, LINEFACT.PRCMEDIO
FROM            CABEFACV INNER JOIN LINEFACT ON CABEFACV.IDFACV = LINEFACT.IDFACV
WHERE CONTABLE='F' 
UNION ALL
SELECT        TIPOCONT, CABEALBV.FECHA, CABEALBV.CODCLI, CASE FACTURABLE WHEN 'T' THEN 0 ELSE LINEALBA.UNIDADES END UNI_CONTADO, CASE FACTURABLE WHEN 'T' THEN 0 ELSE LINEALBA.BASE END VENTA_CONTADO, CASE FACTURABLE WHEN 'T' THEN LINEALBA.UNIDADES ELSE 0 END UNI_CREDITO, CASE FACTURABLE WHEN 'T' THEN LINEALBA.BASE ELSE 0 END VENTA_CREDITO, LINEALBA.PRCMEDIO
FROM            CABEALBV INNER JOIN LINEALBA ON CABEALBV.IDALBV = LINEALBA.IDALBV
WHERE LINEALBA.SITUACION='A'
) AS VENTAS
WHERE CODCLI = @CODCLI AND LTRIM(TIPOCONT)&lt;&gt;'2'
GROUP BY YEAR(FECHA), MONTH(FECHA)</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="CODCLI" ColumnName="CODCLI" DataSourceName="SELECT TIPOCONT, CABEFACV.FECHA, CABEFACV.CODCLI, 0 UNI_CONTADO, 0 VENTA_CONTADO, LINEFACT.UNIDADES UNI_CREDITO, LINEFACT.BASE VENTA_CREDITO, LINEFACT.PRCMEDIO FROM CABEFACV INNER JOIN LINEFACT ON CABEFACV.IDFACV = LINEFACT.IDFACV WHERE CONTABLE='F' UNION ALL SELECT TIPOCONT, CABEALBV.FECHA, CABEALBV.CODCLI, CASE FACTURABLE WHEN 'T' THEN 0 ELSE LINEALBA.UNIDADES END UNI_CONTADO, CASE FACTURABLE WHEN 'T' THEN 0 ELSE LINEALBA.BASE END VENTA_CONTADO, CASE FACTURABLE WHEN 'T' THEN LINEALBA.UNIDADES ELSE 0 END UNI_CREDITO, CASE FACTURABLE WHEN 'T' THEN LINEALBA.BASE ELSE 0 END VENTA_CREDITO, LINEALBA.PRCMEDIO FROM CABEALBV INNER JOIN LINEALBA ON CABEALBV.IDALBV = LINEALBA.IDALBV WHERE LINEALBA.SITUACION='A'" DataTypeServer="varchar(8)" DbType="AnsiString" Direction="Input" ParameterName="@CODCLI" Precision="0" Scale="0" Size="8" SourceColumn="CODCLI" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="SqlConection (Settings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Familia" GenerateMethods="Fill" GenerateShortCommands="true" GeneratorSourceName="Familia" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataBy4" UserSourceName="Familia">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        YEAR(VENTAS.FECHA) AS EJERCICIO, MONTH(VENTAS.FECHA) AS MES, SUM(VENTAS.VENTA_CONTADO) AS VENTA_CONTADO, SUM(VENTAS.VENTA_CREDITO) 
                         AS VENTA_CREDITO, SUM(VENTAS.UNI_CONTADO * VENTAS.PRCMEDIO) AS COSTE_CONTADO, SUM(VENTAS.UNI_CREDITO * VENTAS.PRCMEDIO) 
                         AS COSTE_CREDITO, SUM(VENTAS.COMPRA) AS COMPRA, SUM(VENTAS.UNI_CONTADO) AS UNI_CONTADO, SUM(VENTAS.UNI_CREDITO) AS UNI_CREDITO, 
                         SUM(VENTAS.UNI_COMPRA) AS UNI_COMPRA
FROM            (SELECT        CABEFACV.FECHA, LINEFACT.CODALM, LINEFACT.CODART, 0 AS UNI_CONTADO, 0 AS VENTA_CONTADO, LINEFACT.UNIDADES AS UNI_CREDITO, 
                                                    LINEFACT.BASE AS VENTA_CREDITO, LINEFACT.PRCMEDIO, 0 AS UNI_COMPRA, 0 AS COMPRA
                          FROM            CABEFACV INNER JOIN
                                                    LINEFACT ON CABEFACV.IDFACV = LINEFACT.IDFACV
                          WHERE        (CABEFACV.CONTABLE = 'F')
                          UNION ALL
                          SELECT        CABEALBV.FECHA, LINEALBA.CODALM, LINEALBA.CODART, CASE FACTURABLE WHEN 'T' THEN 0 ELSE LINEALBA.UNIDADES END AS UNI_CONTADO, 
                                                   CASE FACTURABLE WHEN 'T' THEN 0 ELSE LINEALBA.BASE END AS VENTA_CONTADO, 
                                                   CASE FACTURABLE WHEN 'T' THEN LINEALBA.UNIDADES ELSE 0 END AS UNI_CREDITO, 
                                                   CASE FACTURABLE WHEN 'T' THEN LINEALBA.BASE ELSE 0 END AS VENTA_CREDITO, LINEALBA.PRCMEDIO, 0 AS UNI_COMPRA, 0 AS COMPRA
                          FROM            CABEALBV INNER JOIN
                                                   LINEALBA ON CABEALBV.IDALBV = LINEALBA.IDALBV
                          WHERE        (CABEALBV.SITUACION = 'A')
                          UNION ALL
                          SELECT        CABEALBC.FECHA, LINEALBA_1.CODALM, LINEALBA_1.CODART, 0 AS UNI_CONTADO, 0 AS VENTA_CONTADO, 0 AS UNI_CREDITO, 
                                                   0 AS VENTA_CREDITO, 0 AS PRCMEDIO, LINEALBA_1.UNIDADES AS UNI_COMPRA, LINEALBA_1.BASE AS COMPRA
                          FROM            CABEALBC INNER JOIN
                                                   LINEALBA AS LINEALBA_1 ON CABEALBC.IDALBC = LINEALBA_1.IDALBC
                          WHERE        (CABEALBC.SITUACION = 'A')
                          UNION ALL
                          SELECT        CABEFACC.FECHA, LINEFACT_1.CODALM, LINEFACT_1.CODART, 0 AS UNI_CONTADO, 0 AS VENTA_CONTADO, 0 AS UNI_CREDITO, 
                                                   0 AS VENTA_CREDITO, 0 AS PRCMEDIO, LINEFACT_1.UNIDADES AS UNI_COMPRA, LINEFACT_1.BASE AS COMPRA
                          FROM            CABEFACC INNER JOIN
                                                   LINEFACT AS LINEFACT_1 ON CABEFACC.IDFACC = LINEFACT_1.IDFACC
                          WHERE        (CABEFACC.CONTABLE = 'F')) AS VENTAS INNER JOIN
                         ARTICULO ON ARTICULO.CODART = VENTAS.CODART INNER JOIN
                         FAMILIAS ON ARTICULO.CODFAMEST = FAMILIAS.CODFAM AND FAMILIAS.FICHERO = 'Estadis' LEFT OUTER JOIN
                         SIE_ESTRUCTURASFAMILIAARTICULO ON FAMILIAS.ID = SIE_ESTRUCTURASFAMILIAARTICULO.ID_FAMILIAHIJA LEFT OUTER JOIN
                         FAMILIAS AS FamiliaPadre ON FamiliaPadre.ID = SIE_ESTRUCTURASFAMILIAARTICULO.ID_FAMILIAPADRE
WHERE        (VENTAS.CODALM = @CODALM) AND (FAMILIAS.CODFAM = @CODFAM) OR
                         (VENTAS.CODALM = @CODALM) AND (FamiliaPadre.CODFAM = @CODFAM) OR
                         (FAMILIAS.CODFAM = @CODFAM) AND (@CODALM = '') OR
                         (FamiliaPadre.CODFAM = @CODFAM) AND (@CODALM = '')
GROUP BY YEAR(VENTAS.FECHA), MONTH(VENTAS.FECHA)</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="CODALM" ColumnName="CODALM" DataSourceName="SELECT CABEFACV.FECHA, LINEFACT.CODALM, LINEFACT.CODART, 0 AS UNI_CONTADO, 0 AS VENTA_CONTADO, LINEFACT.UNIDADES AS UNI_CREDITO, LINEFACT.BASE AS VENTA_CREDITO, LINEFACT.PRCMEDIO, 0 AS UNI_COMPRA, 0 AS COMPRA FROM CABEFACV INNER JOIN LINEFACT ON CABEFACV.IDFACV = LINEFACT.IDFACV WHERE (CABEFACV.CONTABLE = 'F') UNION ALL SELECT CABEALBV.FECHA, LINEALBA.CODALM, LINEALBA.CODART, CASE FACTURABLE WHEN 'T' THEN 0 ELSE LINEALBA.UNIDADES END AS UNI_CONTADO, CASE FACTURABLE WHEN 'T' THEN 0 ELSE LINEALBA.BASE END AS VENTA_CONTADO, CASE FACTURABLE WHEN 'T' THEN LINEALBA.UNIDADES ELSE 0 END AS UNI_CREDITO, CASE FACTURABLE WHEN 'T' THEN LINEALBA.BASE ELSE 0 END AS VENTA_CREDITO, LINEALBA.PRCMEDIO, 0 AS UNI_COMPRA, 0 AS COMPRA FROM CABEALBV INNER JOIN LINEALBA ON CABEALBV.IDALBV = LINEALBA.IDALBV WHERE (CABEALBV.SITUACION = 'A') UNION ALL SELECT CABEALBC.FECHA, LINEALBA_1.CODALM, LINEALBA_1.CODART, 0 AS UNI_CONTADO, 0 AS VENTA_CONTADO, 0 AS UNI_CREDITO, 0 AS VENTA_CREDITO, 0 AS PRCMEDIO, LINEALBA_1.UNIDADES AS UNI_COMPRA, LINEALBA_1.BASE AS COMPRA FROM CABEALBC INNER JOIN LINEALBA AS LINEALBA_1 ON CABEALBC.IDALBC = LINEALBA_1.IDALBC WHERE (CABEALBC.SITUACION = 'A') UNION ALL SELECT CABEFACC.FECHA, LINEFACT_1.CODALM, LINEFACT_1.CODART, 0 AS UNI_CONTADO, 0 AS VENTA_CONTADO, 0 AS UNI_CREDITO, 0 AS VENTA_CREDITO, 0 AS PRCMEDIO, LINEFACT_1.UNIDADES AS UNI_COMPRA, LINEFACT_1.BASE AS COMPRA FROM CABEFACC INNER JOIN LINEFACT AS LINEFACT_1 ON CABEFACC.IDFACC = LINEFACT_1.IDFACC WHERE (CABEFACC.CONTABLE = 'F')" DataTypeServer="varchar(8)" DbType="AnsiString" Direction="Input" ParameterName="@CODALM" Precision="0" Scale="0" Size="8" SourceColumn="CODALM" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODFAM" ColumnName="CODFAM" DataSourceName="BDMOLINA.dbo.FAMILIAS" DataTypeServer="varchar(8)" DbType="AnsiString" Direction="Input" ParameterName="@CODFAM" Precision="0" ProviderType="VarChar" Scale="0" Size="8" SourceColumn="CODFAM" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="SqlConection (Settings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FamiliaAMM" GenerateMethods="Fill" GenerateShortCommands="true" GeneratorSourceName="FamiliaAMM" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataBy5" UserSourceName="FamiliaAMM">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        YEAR(FECHA) AS EJERCICIO, MONTH(FECHA) AS MES, SUM(VENTA_CONTADO) AS VENTA_CONTADO, SUM(VENTA_CREDITO) AS VENTA_CREDITO, 
                         SUM(UNI_CONTADO * VENTAS.PRCMEDIO) AS COSTE_CONTADO, SUM(UNI_CREDITO * VENTAS.PRCMEDIO) AS COSTE_CREDITO, SUM(COMPRA) AS COMPRA, SUM(UNI_CONTADO) 
                         AS UNI_CONTADO, SUM(UNI_CREDITO) AS UNI_CREDITO, SUM(UNI_COMPRA) AS UNI_COMPRA
FROM            (SELECT        CABEFACV.FECHA, LINEFACT.CODALM, LINEFACT.CODART, 0 AS UNI_CONTADO, 0 AS VENTA_CONTADO, LINEFACT.UNIDADES AS UNI_CREDITO, 
                                                    LINEFACT.BASE AS VENTA_CREDITO, LINEFACT.PRCMEDIO, 0 AS UNI_COMPRA, 0 AS COMPRA
                          FROM            CABEFACV INNER JOIN
                                                    LINEFACT ON CABEFACV.IDFACV = LINEFACT.IDFACV
                          WHERE        (CABEFACV.CONTABLE = 'F') AND (LTRIM(CABEFACV.SERIE) &lt;&gt; '6')
                          UNION ALL
                          SELECT        CABEALBV.FECHA, LINEALBA.CODALM, LINEALBA.CODART, CASE FACTURABLE WHEN 'T' THEN 0 ELSE LINEALBA.UNIDADES END AS UNI_CONTADO, 
                                                   CASE FACTURABLE WHEN 'T' THEN 0 ELSE LINEALBA.BASE END AS VENTA_CONTADO, 
                                                   CASE FACTURABLE WHEN 'T' THEN LINEALBA.UNIDADES ELSE 0 END AS UNI_CREDITO, 
                                                   CASE FACTURABLE WHEN 'T' THEN LINEALBA.BASE ELSE 0 END AS VENTA_CREDITO, LINEALBA.PRCMEDIO, 0 AS UNI_COMPRA, 0 AS COMPRA
                          FROM            CABEALBV INNER JOIN
                                                   LINEALBA ON CABEALBV.IDALBV = LINEALBA.IDALBV
                          WHERE        (CABEALBV.SITUACION = 'A') AND (LTRIM(CABEALBV.SERIE) &lt;&gt; '6')
                          UNION ALL
                          SELECT        CABEALBC.FECHA, LINEALBA.CODALM, LINEALBA.CODART, 0 AS UNI_CONTADO, 0 AS VENTA_CONTADO, 0 AS UNI_CREDITO, 
                                                   0 AS VENTA_CREDITO, 0 AS PRCMEDIO, LINEALBA.UNIDADES AS UNI_COMPRA, LINEALBA.BASE AS COMPRA
                          FROM            CABEALBC INNER JOIN
                                                   LINEALBA ON CABEALBC.IDALBC = LINEALBA.IDALBC
                          WHERE        CABEALBC.SITUACION='A' AND (LTRIM(CABEALBC.CODPRO) &lt;&gt; '911')
                         UNION ALL
                         SELECT        CABEFACC.FECHA, LINEFACT.CODALM, LINEFACT.CODART, 0 UNI_CONTADO, 0 VENTA_CONTADO, 0 UNI_CREDITO, 0 VENTA_CREDITO, 0 PRCMEDIO, LINEFACT.UNIDADES AS UNI_COMPRA, LINEFACT.BASE AS COMPRA
                         FROM            CABEFACC INNER JOIN LINEFACT ON CABEFACC.IDFACC = LINEFACT.IDFACC
                         WHERE CONTABLE = 'F' AND (LTRIM(CABEFACC.CODPRO) &lt;&gt; '911')
) AS VENTAS INNER JOIN
                         ARTICULO ON ARTICULO.CODART = VENTAS.CODART INNER JOIN
                         FAMILIAS ON ARTICULO.CODFAMEST = FAMILIAS.CODFAM AND FAMILIAS.FICHERO = 'Estadis' LEFT OUTER JOIN
                         SIE_ESTRUCTURASFAMILIAARTICULO ON FAMILIAS.ID = SIE_ESTRUCTURASFAMILIAARTICULO.ID_FAMILIAHIJA LEFT OUTER JOIN
                         FAMILIAS AS FamiliaPadre ON FamiliaPadre.ID = SIE_ESTRUCTURASFAMILIAARTICULO.ID_FAMILIAPADRE
WHERE        (VENTAS.CODALM = @CODALM) AND (FAMILIAS.CODFAM = @CODFAM) OR
                         (VENTAS.CODALM = @CODALM) AND (FamiliaPadre.CODFAM = @CODFAM) OR
                         (FAMILIAS.CODFAM = @CODFAM) AND (@CODALM = '') OR
                         (FamiliaPadre.CODFAM = @CODFAM) AND (@CODALM = '')
GROUP BY YEAR(FECHA), MONTH(FECHA)</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="CODALM" ColumnName="CODALM" DataSourceName="SELECT CABEFACV.FECHA, LINEFACT.CODALM, LINEFACT.CODART, 0 AS UNI_CONTADO, 0 AS VENTA_CONTADO, LINEFACT.UNIDADES AS UNI_CREDITO, LINEFACT.BASE AS VENTA_CREDITO, LINEFACT.PRCMEDIO, 0 AS UNI_COMPRA, 0 AS COMPRA FROM CABEFACV INNER JOIN LINEFACT ON CABEFACV.IDFACV = LINEFACT.IDFACV WHERE (CABEFACV.CONTABLE = 'F') AND (LTRIM(CABEFACV.SERIE) &lt;&gt; '6') UNION ALL SELECT CABEALBV.FECHA, LINEALBA.CODALM, LINEALBA.CODART, CASE FACTURABLE WHEN 'T' THEN 0 ELSE LINEALBA.UNIDADES END AS UNI_CONTADO, CASE FACTURABLE WHEN 'T' THEN 0 ELSE LINEALBA.BASE END AS VENTA_CONTADO, CASE FACTURABLE WHEN 'T' THEN LINEALBA.UNIDADES ELSE 0 END AS UNI_CREDITO, CASE FACTURABLE WHEN 'T' THEN LINEALBA.BASE ELSE 0 END AS VENTA_CREDITO, LINEALBA.PRCMEDIO, 0 AS UNI_COMPRA, 0 AS COMPRA FROM CABEALBV INNER JOIN LINEALBA ON CABEALBV.IDALBV = LINEALBA.IDALBV WHERE (CABEALBV.SITUACION = 'A') AND (LTRIM(CABEALBV.SERIE) &lt;&gt; '6') UNION ALL SELECT CABEALBC.FECHA, LINEALBA.CODALM, LINEALBA.CODART, 0 AS UNI_CONTADO, 0 AS VENTA_CONTADO, 0 AS UNI_CREDITO, 0 AS VENTA_CREDITO, 0 AS PRCMEDIO, LINEALBA.UNIDADES AS UNI_COMPRA, LINEALBA.BASE AS COMPRA FROM CABEALBC INNER JOIN LINEALBA ON CABEALBC.IDALBC = LINEALBA.IDALBC WHERE CABEALBC.SITUACION='A' AND (LTRIM(CABEALBC.CODPRO) &lt;&gt; '911') UNION ALL SELECT CABEFACC.FECHA, LINEFACT.CODALM, LINEFACT.CODART, 0 UNI_CONTADO, 0 VENTA_CONTADO, 0 UNI_CREDITO, 0 VENTA_CREDITO, 0 PRCMEDIO, LINEFACT.UNIDADES AS UNI_COMPRA, LINEFACT.BASE AS COMPRA FROM CABEFACC INNER JOIN LINEFACT ON CABEFACC.IDFACC = LINEFACT.IDFACC WHERE CONTABLE = 'F' AND (LTRIM(CABEFACC.CODPRO) &lt;&gt; '911')" DataTypeServer="varchar(8)" DbType="AnsiString" Direction="Input" ParameterName="@CODALM" Precision="0" Scale="0" Size="8" SourceColumn="CODALM" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODFAM" ColumnName="CODFAM" DataSourceName="BDMOLINA.dbo.FAMILIAS" DataTypeServer="varchar(8)" DbType="AnsiString" Direction="Input" ParameterName="@CODFAM" Precision="0" ProviderType="VarChar" Scale="0" Size="8" SourceColumn="CODFAM" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="SqlConection (Settings)" DbObjectName="SELECT CODPRO, YEAR(FECHA) AS EJERCICIO, MONTH(FECHA) AS MES, BASE FROM CABEALBC WHERE SITUACION = 'A' UNION ALL SELECT CODPRO, YEAR(FECHA) AS EJERCICIO, MONTH(FECHA) AS MES, BASE FROM CABEFACC WHERE CONTABLE = 'F'" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Proveedor" GenerateMethods="Fill" GenerateShortCommands="true" GeneratorSourceName="Proveedor" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataBy6" UserSourceName="Proveedor">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT EJERCICIO, MES, SUM(BASE) AS COMPRA, 0 COSTE_CONTADO, 0 COSTE_CREDITO, 0 VENTA_CONTADO, 0 VENTA_CREDITO, 0 UNI_CONTADO, 0 UNI_CREDITO 
FROM
(
SELECT        CODPRO, YEAR(FECHA) AS EJERCICIO, MONTH(FECHA) AS MES, BASE
FROM CABEALBC
WHERE SITUACION = 'A'
UNION ALL
SELECT        CODPRO, YEAR(FECHA) AS EJERCICIO, MONTH(FECHA) AS MES, BASE
FROM CABEFACC
WHERE CONTABLE = 'F'
) AS COMPRAS
WHERE CODPRO = @CODPRO
GROUP BY EJERCICIO, MES</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="CODPRO" ColumnName="CODPRO" DataSourceName="SELECT CODPRO, YEAR(FECHA) AS EJERCICIO, MONTH(FECHA) AS MES, BASE FROM CABEALBC WHERE SITUACION = 'A' UNION ALL SELECT CODPRO, YEAR(FECHA) AS EJERCICIO, MONTH(FECHA) AS MES, BASE FROM CABEFACC WHERE CONTABLE = 'F'" DataTypeServer="varchar(8)" DbType="AnsiString" Direction="Input" ParameterName="@CODPRO" Precision="0" Scale="0" Size="8" SourceColumn="CODPRO" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="SqlConection (Settings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Representante" GenerateMethods="Fill" GenerateShortCommands="true" GeneratorSourceName="Representante" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataBy7" UserSourceName="Representante">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        YEAR(FECHA) AS EJERCICIO, MONTH(FECHA) AS MES, SUM(VENTA_CONTADO) AS VENTA_CONTADO, SUM(VENTA_CREDITO) VENTA_CREDITO, SUM(UNI_CONTADO * PRCMEDIO) AS COSTE_CONTADO, SUM(UNI_CREDITO * PRCMEDIO) AS COSTE_CREDITO, 0 AS COMPRA, SUM(UNI_CONTADO) UNI_CONTADO, SUM(UNI_CREDITO) UNI_CREDITO
FROM            (
SELECT        CABEFACV.FECHA, LINEFACT.CODREP, 0 UNI_CONTADO, 0 VENTA_CONTADO, LINEFACT.UNIDADES UNI_CREDITO, LINEFACT.BASE VENTA_CREDITO, LINEFACT.PRCMEDIO
FROM            CABEFACV INNER JOIN LINEFACT ON CABEFACV.IDFACV = LINEFACT.IDFACV
WHERE CONTABLE='F'
UNION ALL
SELECT        CABEALBV.FECHA, LINEALBA.CODREP, CASE FACTURABLE WHEN 'T' THEN 0 ELSE LINEALBA.UNIDADES END UNI_CONTADO, CASE FACTURABLE WHEN 'T' THEN 0 ELSE LINEALBA.BASE END VENTA_CONTADO, CASE FACTURABLE WHEN 'T' THEN LINEALBA.UNIDADES ELSE 0 END UNI_CREDITO, CASE FACTURABLE WHEN 'T' THEN LINEALBA.BASE ELSE 0 END VENTA_CREDITO, LINEALBA.PRCMEDIO
FROM            CABEALBV INNER JOIN LINEALBA ON CABEALBV.IDALBV = LINEALBA.IDALBV
WHERE LINEALBA.SITUACION='A'
) AS VENTAS
WHERE  CODREP = @CODREP
GROUP BY YEAR(FECHA), MONTH(FECHA)</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="CODREP" ColumnName="CODREP" DataSourceName="SELECT CABEFACV.FECHA, LINEFACT.CODREP, 0 UNI_CONTADO, 0 VENTA_CONTADO, LINEFACT.UNIDADES UNI_CREDITO, LINEFACT.BASE VENTA_CREDITO, LINEFACT.PRCMEDIO FROM CABEFACV INNER JOIN LINEFACT ON CABEFACV.IDFACV = LINEFACT.IDFACV WHERE CONTABLE='F' UNION ALL SELECT CABEALBV.FECHA, LINEALBA.CODREP, CASE FACTURABLE WHEN 'T' THEN 0 ELSE LINEALBA.UNIDADES END UNI_CONTADO, CASE FACTURABLE WHEN 'T' THEN 0 ELSE LINEALBA.BASE END VENTA_CONTADO, CASE FACTURABLE WHEN 'T' THEN LINEALBA.UNIDADES ELSE 0 END UNI_CREDITO, CASE FACTURABLE WHEN 'T' THEN LINEALBA.BASE ELSE 0 END VENTA_CREDITO, LINEALBA.PRCMEDIO FROM CABEALBV INNER JOIN LINEALBA ON CABEALBV.IDALBV = LINEALBA.IDALBV WHERE LINEALBA.SITUACION='A'" DataTypeServer="varchar(8)" DbType="AnsiString" Direction="Input" ParameterName="@CODREP" Precision="0" Scale="0" Size="8" SourceColumn="CODREP" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="SqlConection (Settings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Ruta" GenerateMethods="Fill" GenerateShortCommands="true" GeneratorSourceName="Ruta" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataBy8" UserSourceName="Ruta">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        YEAR(FECHA) AS EJERCICIO, MONTH(FECHA) AS MES, SUM(VENTA_CONTADO) AS VENTA_CONTADO, SUM(VENTA_CREDITO) VENTA_CREDITO, SUM(UNI_CONTADO * PRCMEDIO) AS COSTE_CONTADO, SUM(UNI_CREDITO * PRCMEDIO) AS COSTE_CREDITO, 0 AS COMPRA, SUM(UNI_CONTADO) UNI_CONTADO, SUM(UNI_CREDITO) UNI_CREDITO
FROM            (
SELECT        CABEFACV.FECHA, CABEFACV.CODCLI, 0 UNI_CONTADO, 0 VENTA_CONTADO, LINEFACT.UNIDADES UNI_CREDITO, LINEFACT.BASE VENTA_CREDITO, LINEFACT.PRCMEDIO
FROM            CABEFACV INNER JOIN LINEFACT ON CABEFACV.IDFACV = LINEFACT.IDFACV
WHERE CONTABLE='F'
UNION ALL
SELECT        CABEALBV.FECHA, CABEALBV.CODCLI, CASE FACTURABLE WHEN 'T' THEN 0 ELSE LINEALBA.UNIDADES END UNI_CONTADO, CASE FACTURABLE WHEN 'T' THEN 0 ELSE LINEALBA.BASE END VENTA_CONTADO, CASE FACTURABLE WHEN 'T' THEN LINEALBA.UNIDADES ELSE 0 END UNI_CREDITO, CASE FACTURABLE WHEN 'T' THEN LINEALBA.BASE ELSE 0 END VENTA_CREDITO, LINEALBA.PRCMEDIO
FROM            CABEALBV INNER JOIN LINEALBA ON CABEALBV.IDALBV = LINEALBA.IDALBV
WHERE LINEALBA.SITUACION='A'
) AS VENTAS
LEFT JOIN CLIENTES ON CLIENTES.CODCLI = VENTAS.CODCLI
WHERE CLIENTES.RUTA = @RUTA
GROUP BY YEAR(FECHA), MONTH(FECHA)</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="true" AutogeneratedName="RUTA" ColumnName="RUTA" DataSourceName="BDMOLINA.dbo.CLIENTES" DataTypeServer="varchar(8)" DbType="AnsiString" Direction="Input" ParameterName="@RUTA" Precision="0" ProviderType="VarChar" Scale="0" Size="8" SourceColumn="RUTA" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="DETALLE_VENTASTableAdapter" GeneratorDataComponentClassName="DETALLE_VENTASTableAdapter" Name="DETALLE_VENTAS" UserDataComponentName="DETALLE_VENTASTableAdapter">
            <MainSource>
              <DbSource ConnectionRef="SqlConection (Settings)" DbObjectName="SELECT 'FV' AS TIPDOC, 'Vta.Credito' AS GRUPO, CABEFACV.IDFACV AS IDDOC, CABEFACV.FECHA, TIPOCONT, SERIE, NUMDOC, CODCLI CLIPRO, NOMCLI NOMBRE, LINEFACT.CODREP, LINEFACT.CODALM, LINEFACT.CODART, LINEFACT.DESCLIN, LINEFACT.UNIDADES, LINEFACT.PRCMONEDA, LINEFACT.DESC1, LINEFACT.DESC2, LINEFACT.DESC3, LINEFACT.DESC4, LINEFACT.BASE, LINEFACT.PRCMEDIO FROM CABEFACV INNER JOIN LINEFACT ON CABEFACV.IDFACV = LINEFACT.IDFACV WHERE CONTABLE='F' UNION ALL SELECT 'AV' AS TIPDOC, CASE FACTURABLE WHEN 'T' THEN 'Vta.Credito' ELSE 'Contado' END AS GRUPO, CABEALBV.IDALBV AS IDDOC, CABEALBV.FECHA, TIPOCONT, SERIE, NUMDOC, CODCLI CLIPRO, NOMCLI NOMBRE, LINEALBA.CODREP, LINEALBA.CODALM, LINEALBA.CODART, LINEALBA.DESCLIN, LINEALBA.UNIDADES, LINEALBA.PRCMONEDA, LINEALBA.DESC1, LINEALBA.DESC2, LINEALBA.DESC3, LINEALBA.DESC4, LINEALBA.BASE, LINEALBA.PRCMEDIO FROM CABEALBV INNER JOIN LINEALBA ON CABEALBV.IDALBV = LINEALBA.IDALBV WHERE LINEALBA.SITUACION='A' UNION ALL SELECT 'FC' AS TIPDOC, 'Compras' AS GRUPO, CABEFACC.IDFACC AS IDDOC, CABEFACC.FECHA, TIPOCONT, SERIE, NUMDOC, CODPRO CLIPRO, NOMPRO NOMBRE, LINEFACT.CODREP, LINEFACT.CODALM, LINEFACT.CODART, LINEFACT.DESCLIN, LINEFACT.UNIDADES, LINEFACT.PRCMONEDA, LINEFACT.DESC1, LINEFACT.DESC2, LINEFACT.DESC3, LINEFACT.DESC4, LINEFACT.BASE, LINEFACT.PRCMEDIO FROM CABEFACC INNER JOIN LINEFACT ON CABEFACC.IDFACC = LINEFACT.IDFACC WHERE CONTABLE='F'" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Fill" GenerateShortCommands="false" GeneratorSourceName="Fill" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT     TIPDOC, IDDOC, GRUPO, FECHA, TIPOCONT, SERIE, NUMDOC, CLIPRO, NOMBRE, CODREP, CODALM, CODART, DESCLIN, UNIDADES, PRCMONEDA, DESC1, DESC2, DESC3, DESC4, BASE, PRCMEDIO
FROM            (
SELECT       'FV' AS TIPDOC, 'Vta.Credito' AS GRUPO, CABEFACV.IDFACV AS IDDOC, CABEFACV.FECHA, TIPOCONT, SERIE, NUMDOC, CODCLI CLIPRO, NOMCLI NOMBRE, LINEFACT.CODREP, LINEFACT.CODALM, LINEFACT.CODART, LINEFACT.DESCLIN, LINEFACT.UNIDADES, LINEFACT.PRCMONEDA, LINEFACT.DESC1, LINEFACT.DESC2, LINEFACT.DESC3, LINEFACT.DESC4, LINEFACT.BASE, LINEFACT.PRCMEDIO
FROM            CABEFACV INNER JOIN LINEFACT ON CABEFACV.IDFACV = LINEFACT.IDFACV
WHERE CONTABLE='F'
UNION ALL
SELECT       'AV' AS TIPDOC, CASE FACTURABLE WHEN 'T' THEN 'Vta.Credito' ELSE 'Contado' END AS GRUPO, CABEALBV.IDALBV AS IDDOC, CABEALBV.FECHA, TIPOCONT, SERIE, NUMDOC, CODCLI CLIPRO, NOMCLI NOMBRE, LINEALBA.CODREP, LINEALBA.CODALM, LINEALBA.CODART, LINEALBA.DESCLIN, LINEALBA.UNIDADES, LINEALBA.PRCMONEDA, LINEALBA.DESC1, LINEALBA.DESC2, LINEALBA.DESC3, LINEALBA.DESC4, LINEALBA.BASE, LINEALBA.PRCMEDIO
FROM            CABEALBV INNER JOIN LINEALBA ON CABEALBV.IDALBV = LINEALBA.IDALBV
WHERE LINEALBA.SITUACION='A'
UNION ALL
SELECT       'FC' AS TIPDOC, 'Compras' AS GRUPO, CABEFACC.IDFACC AS IDDOC, CABEFACC.FECHA, TIPOCONT, SERIE, NUMDOC, CODPRO CLIPRO, NOMPRO NOMBRE, LINEFACT.CODREP, LINEFACT.CODALM, LINEFACT.CODART, LINEFACT.DESCLIN, LINEFACT.UNIDADES, LINEFACT.PRCMONEDA, LINEFACT.DESC1, LINEFACT.DESC2, LINEFACT.DESC3, LINEFACT.DESC4, LINEFACT.BASE, LINEFACT.PRCMEDIO
FROM            CABEFACC INNER JOIN LINEFACT ON CABEFACC.IDFACC = LINEFACT.IDFACC
WHERE CONTABLE='F'
) AS VENTAS
WHERE YEAR(FECHA) = @EJERCICIO AND MONTH(FECHA) = @MES</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="EJERCICIO" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="Decimal" Direction="Input" ParameterName="@EJERCICIO" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="MES" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="Decimal" Direction="Input" ParameterName="@MES" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="TIPDOC" DataSetColumn="TIPDOC" />
              <Mapping SourceColumn="IDDOC" DataSetColumn="IDDOC" />
              <Mapping SourceColumn="FECHA" DataSetColumn="FECHA" />
              <Mapping SourceColumn="TIPOCONT" DataSetColumn="TIPOCONT" />
              <Mapping SourceColumn="SERIE" DataSetColumn="SERIE" />
              <Mapping SourceColumn="NUMDOC" DataSetColumn="NUMDOC" />
              <Mapping SourceColumn="CLIPRO" DataSetColumn="CLIPRO" />
              <Mapping SourceColumn="NOMBRE" DataSetColumn="NOMBRE" />
              <Mapping SourceColumn="CODREP" DataSetColumn="CODREP" />
              <Mapping SourceColumn="CODALM" DataSetColumn="CODALM" />
              <Mapping SourceColumn="CODART" DataSetColumn="CODART" />
              <Mapping SourceColumn="DESCLIN" DataSetColumn="DESCLIN" />
              <Mapping SourceColumn="UNIDADES" DataSetColumn="UNIDADES" />
              <Mapping SourceColumn="PRCMONEDA" DataSetColumn="PRCMONEDA" />
              <Mapping SourceColumn="DESC1" DataSetColumn="DESC1" />
              <Mapping SourceColumn="DESC2" DataSetColumn="DESC2" />
              <Mapping SourceColumn="DESC3" DataSetColumn="DESC3" />
              <Mapping SourceColumn="DESC4" DataSetColumn="DESC4" />
              <Mapping SourceColumn="BASE" DataSetColumn="BASE" />
              <Mapping SourceColumn="PRCMEDIO" DataSetColumn="PRCMEDIO" />
              <Mapping SourceColumn="GRUPO" DataSetColumn="GRUPO" />
            </Mappings>
            <Sources>
              <DbSource ConnectionRef="SqlConection (Settings)" DbObjectName="SELECT 'FV' AS TIPDOC, 'Vta.Credito' AS GRUPO, CABEFACV.IDFACV AS IDDOC, CABEFACV.FECHA, TIPOCONT, SERIE, NUMDOC, CODCLI CLIPRO, NOMCLI NOMBRE, LINEFACT.CODREP, LINEFACT.CODALM, LINEFACT.CODART, LINEFACT.DESCLIN, LINEFACT.UNIDADES, LINEFACT.PRCMONEDA, LINEFACT.DESC1, LINEFACT.DESC2, LINEFACT.DESC3, LINEFACT.DESC4, LINEFACT.BASE, LINEFACT.PRCMEDIO FROM CABEFACV INNER JOIN LINEFACT ON CABEFACV.IDFACV = LINEFACT.IDFACV WHERE CONTABLE='F' UNION ALL SELECT 'AV' AS TIPDOC, CASE FACTURABLE WHEN 'T' THEN 'Vta.Credito' ELSE 'Contado' END AS GRUPO, CABEALBV.IDALBV AS IDDOC, CABEALBV.FECHA, TIPOCONT, SERIE, NUMDOC, CODCLI CLIPRO, NOMCLI NOMBRE, LINEALBA.CODREP, LINEALBA.CODALM, LINEALBA.CODART, LINEALBA.DESCLIN, LINEALBA.UNIDADES, LINEALBA.PRCMONEDA, LINEALBA.DESC1, LINEALBA.DESC2, LINEALBA.DESC3, LINEALBA.DESC4, LINEALBA.BASE, LINEALBA.PRCMEDIO FROM CABEALBV INNER JOIN LINEALBA ON CABEALBV.IDALBV = LINEALBA.IDALBV WHERE CABEALBV.SITUACION='A' UNION ALL SELECT 'AC' AS TIPDOC, 'Compras' AS GRUPO, CABEALBC.IDALBC AS IDDOC, CABEALBC.FECHA, TIPOCONT, SERIE, NUMDOC, CODPRO CLIPRO, NOMPRO NOMBRE, LINEALBA.CODREP, LINEALBA.CODALM, LINEALBA.CODART, LINEALBA.DESCLIN, LINEALBA.UNIDADES, LINEALBA.PRCMONEDA, LINEALBA.DESC1, LINEALBA.DESC2, LINEALBA.DESC3, LINEALBA.DESC4, LINEALBA.BASE, LINEALBA.PRCMEDIO FROM CABEALBC INNER JOIN LINEALBA ON CABEALBC.IDALBC = LINEALBA.IDALBC WHERE CABEALBC.SITUACION = 'A' UNION ALL SELECT 'FC' AS TIPDOC, 'Compras' AS GRUPO, CABEFACC.IDFACC AS IDDOC, CABEFACC.FECHA, TIPOCONT, SERIE, NUMDOC, CODPRO CLIPRO, NOMPRO NOMBRE, LINEFACT.CODREP, LINEFACT.CODALM, LINEFACT.CODART, LINEFACT.DESCLIN, LINEFACT.UNIDADES, LINEFACT.PRCMONEDA, LINEFACT.DESC1, LINEFACT.DESC2, LINEFACT.DESC3, LINEFACT.DESC4, LINEFACT.BASE, LINEFACT.PRCMEDIO FROM CABEFACC INNER JOIN LINEFACT ON CABEFACC.IDFACC = LINEFACT.IDFACC WHERE CONTABLE = 'F'" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Almacen" GenerateMethods="Fill" GenerateShortCommands="true" GeneratorSourceName="Almacen" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataBy" UserSourceName="Almacen">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT     TIPDOC, IDDOC, GRUPO, FECHA, TIPOCONT, SERIE, NUMDOC, CLIPRO, NOMBRE, CODREP, CODALM, CODART, DESCLIN, UNIDADES, PRCMONEDA, DESC1, DESC2, DESC3, DESC4, BASE, PRCMEDIO
FROM            (
SELECT        'FV' AS TIPDOC, 'Vta.Credito' AS GRUPO, CABEFACV.IDFACV AS IDDOC, CABEFACV.FECHA, TIPOCONT, SERIE, NUMDOC, CODCLI CLIPRO, NOMCLI NOMBRE, LINEFACT.CODREP, LINEFACT.CODALM, LINEFACT.CODART, LINEFACT.DESCLIN, LINEFACT.UNIDADES, LINEFACT.PRCMONEDA, LINEFACT.DESC1, LINEFACT.DESC2, LINEFACT.DESC3, LINEFACT.DESC4, LINEFACT.BASE, LINEFACT.PRCMEDIO
FROM            CABEFACV INNER JOIN LINEFACT ON CABEFACV.IDFACV = LINEFACT.IDFACV
WHERE CONTABLE='F'
UNION ALL
SELECT       'AV' AS TIPDOC, CASE FACTURABLE WHEN 'T' THEN 'Vta.Credito' ELSE 'Contado' END AS GRUPO, CABEALBV.IDALBV AS IDDOC, CABEALBV.FECHA, TIPOCONT, SERIE, NUMDOC, CODCLI CLIPRO, NOMCLI NOMBRE, LINEALBA.CODREP, LINEALBA.CODALM, LINEALBA.CODART, LINEALBA.DESCLIN, LINEALBA.UNIDADES, LINEALBA.PRCMONEDA, LINEALBA.DESC1, LINEALBA.DESC2, LINEALBA.DESC3, LINEALBA.DESC4, LINEALBA.BASE, LINEALBA.PRCMEDIO
FROM            CABEALBV INNER JOIN LINEALBA ON CABEALBV.IDALBV = LINEALBA.IDALBV
WHERE CABEALBV.SITUACION='A'
UNION ALL
SELECT       'AC' AS TIPDOC, 'Compras' AS GRUPO, CABEALBC.IDALBC AS IDDOC, CABEALBC.FECHA, TIPOCONT, SERIE, NUMDOC, CODPRO CLIPRO, NOMPRO NOMBRE, LINEALBA.CODREP, LINEALBA.CODALM, LINEALBA.CODART, LINEALBA.DESCLIN, LINEALBA.UNIDADES, LINEALBA.PRCMONEDA, LINEALBA.DESC1, LINEALBA.DESC2, LINEALBA.DESC3, LINEALBA.DESC4, LINEALBA.BASE, LINEALBA.PRCMEDIO
FROM            CABEALBC INNER JOIN LINEALBA ON CABEALBC.IDALBC = LINEALBA.IDALBC
WHERE CABEALBC.SITUACION = 'A'
UNION ALL
SELECT       'FC' AS TIPDOC, 'Compras' AS GRUPO, CABEFACC.IDFACC AS IDDOC, CABEFACC.FECHA, TIPOCONT, SERIE, NUMDOC, CODPRO CLIPRO, NOMPRO NOMBRE, LINEFACT.CODREP, LINEFACT.CODALM, LINEFACT.CODART, LINEFACT.DESCLIN, LINEFACT.UNIDADES, LINEFACT.PRCMONEDA, LINEFACT.DESC1, LINEFACT.DESC2, LINEFACT.DESC3, LINEFACT.DESC4, LINEFACT.BASE, LINEFACT.PRCMEDIO
FROM            CABEFACC INNER JOIN LINEFACT ON CABEFACC.IDFACC = LINEFACT.IDFACC
WHERE CONTABLE = 'F'
) AS VENTAS
WHERE YEAR(FECHA) = @EJERCICIO AND MONTH(FECHA) = @MES AND CODALM = @CODALM</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="EJERCICIO" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="Decimal" Direction="Input" ParameterName="@EJERCICIO" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="MES" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="Decimal" Direction="Input" ParameterName="@MES" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="CODALM" ColumnName="CODALM" DataSourceName="SELECT 'FV' AS TIPDOC, 'Vta.Credito' AS GRUPO, CABEFACV.IDFACV AS IDDOC, CABEFACV.FECHA, TIPOCONT, SERIE, NUMDOC, CODCLI CLIPRO, NOMCLI NOMBRE, LINEFACT.CODREP, LINEFACT.CODALM, LINEFACT.CODART, LINEFACT.DESCLIN, LINEFACT.UNIDADES, LINEFACT.PRCMONEDA, LINEFACT.DESC1, LINEFACT.DESC2, LINEFACT.DESC3, LINEFACT.DESC4, LINEFACT.BASE, LINEFACT.PRCMEDIO FROM CABEFACV INNER JOIN LINEFACT ON CABEFACV.IDFACV = LINEFACT.IDFACV WHERE CONTABLE='F' UNION ALL SELECT 'AV' AS TIPDOC, CASE FACTURABLE WHEN 'T' THEN 'Vta.Credito' ELSE 'Contado' END AS GRUPO, CABEALBV.IDALBV AS IDDOC, CABEALBV.FECHA, TIPOCONT, SERIE, NUMDOC, CODCLI CLIPRO, NOMCLI NOMBRE, LINEALBA.CODREP, LINEALBA.CODALM, LINEALBA.CODART, LINEALBA.DESCLIN, LINEALBA.UNIDADES, LINEALBA.PRCMONEDA, LINEALBA.DESC1, LINEALBA.DESC2, LINEALBA.DESC3, LINEALBA.DESC4, LINEALBA.BASE, LINEALBA.PRCMEDIO FROM CABEALBV INNER JOIN LINEALBA ON CABEALBV.IDALBV = LINEALBA.IDALBV WHERE CABEALBV.SITUACION='A' UNION ALL SELECT 'AC' AS TIPDOC, 'Compras' AS GRUPO, CABEALBC.IDALBC AS IDDOC, CABEALBC.FECHA, TIPOCONT, SERIE, NUMDOC, CODPRO CLIPRO, NOMPRO NOMBRE, LINEALBA.CODREP, LINEALBA.CODALM, LINEALBA.CODART, LINEALBA.DESCLIN, LINEALBA.UNIDADES, LINEALBA.PRCMONEDA, LINEALBA.DESC1, LINEALBA.DESC2, LINEALBA.DESC3, LINEALBA.DESC4, LINEALBA.BASE, LINEALBA.PRCMEDIO FROM CABEALBC INNER JOIN LINEALBA ON CABEALBC.IDALBC = LINEALBA.IDALBC WHERE CABEALBC.SITUACION = 'A' UNION ALL SELECT 'FC' AS TIPDOC, 'Compras' AS GRUPO, CABEFACC.IDFACC AS IDDOC, CABEFACC.FECHA, TIPOCONT, SERIE, NUMDOC, CODPRO CLIPRO, NOMPRO NOMBRE, LINEFACT.CODREP, LINEFACT.CODALM, LINEFACT.CODART, LINEFACT.DESCLIN, LINEFACT.UNIDADES, LINEFACT.PRCMONEDA, LINEFACT.DESC1, LINEFACT.DESC2, LINEFACT.DESC3, LINEFACT.DESC4, LINEFACT.BASE, LINEFACT.PRCMEDIO FROM CABEFACC INNER JOIN LINEFACT ON CABEFACC.IDFACC = LINEFACT.IDFACC WHERE CONTABLE = 'F'" DataTypeServer="varchar(8)" DbType="AnsiString" Direction="Input" ParameterName="@CODALM" Precision="0" Scale="0" Size="8" SourceColumn="CODALM" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="SqlConection (Settings)" DbObjectName="SELECT 'FV' AS TIPDOC, 'Vta.Credito' AS GRUPO, CABEFACV.IDFACV AS IDDOC, CABEFACV.FECHA, TIPOCONT, SERIE, NUMDOC, CODCLI CLIPRO, NOMCLI NOMBRE, LINEFACT.CODREP, LINEFACT.CODALM, LINEFACT.CODART, LINEFACT.DESCLIN, LINEFACT.UNIDADES, LINEFACT.PRCMONEDA, LINEFACT.DESC1, LINEFACT.DESC2, LINEFACT.DESC3, LINEFACT.DESC4, LINEFACT.BASE, LINEFACT.PRCMEDIO FROM CABEFACV INNER JOIN LINEFACT ON CABEFACV.IDFACV = LINEFACT.IDFACV WHERE CONTABLE='F' UNION ALL SELECT 'AV' AS TIPDOC, CASE FACTURABLE WHEN 'T' THEN 'Vta.Credito' ELSE 'Contado' END AS GRUPO, CABEALBV.IDALBV AS IDDOC, CABEALBV.FECHA, TIPOCONT, SERIE, NUMDOC, CODCLI CLIPRO, NOMCLI NOMBRE, LINEALBA.CODREP, LINEALBA.CODALM, LINEALBA.CODART, LINEALBA.DESCLIN, LINEALBA.UNIDADES, LINEALBA.PRCMONEDA, LINEALBA.DESC1, LINEALBA.DESC2, LINEALBA.DESC3, LINEALBA.DESC4, LINEALBA.BASE, LINEALBA.PRCMEDIO FROM CABEALBV INNER JOIN LINEALBA ON CABEALBV.IDALBV = LINEALBA.IDALBV WHERE CABEALBV.SITUACION='A' UNION ALL SELECT 'AC' AS TIPDOC, 'Compras' AS GRUPO, CABEALBC.IDALBC AS IDDOC, CABEALBC.FECHA, TIPOCONT, SERIE, NUMDOC, CODPRO CLIPRO, NOMPRO NOMBRE, LINEALBA.CODREP, LINEALBA.CODALM, LINEALBA.CODART, LINEALBA.DESCLIN, LINEALBA.UNIDADES, LINEALBA.PRCMONEDA, LINEALBA.DESC1, LINEALBA.DESC2, LINEALBA.DESC3, LINEALBA.DESC4, LINEALBA.BASE, LINEALBA.PRCMEDIO FROM CABEALBC INNER JOIN LINEALBA ON CABEALBC.IDALBC = LINEALBA.IDALBC WHERE CABEALBC.SITUACION = 'A' UNION ALL SELECT 'FC' AS TIPDOC, 'Compras' AS GRUPO, CABEFACC.IDFACC AS IDDOC, CABEFACC.FECHA, TIPOCONT, SERIE, NUMDOC, CODPRO CLIPRO, NOMPRO NOMBRE, LINEFACT.CODREP, LINEFACT.CODALM, LINEFACT.CODART, LINEFACT.DESCLIN, LINEFACT.UNIDADES, LINEFACT.PRCMONEDA, LINEFACT.DESC1, LINEFACT.DESC2, LINEFACT.DESC3, LINEFACT.DESC4, LINEFACT.BASE, LINEFACT.PRCMEDIO FROM CABEFACC INNER JOIN LINEFACT ON CABEFACC.IDFACC = LINEFACT.IDFACC WHERE CONTABLE = 'F'" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Artículo" GenerateMethods="Fill" GenerateShortCommands="true" GeneratorSourceName="Artículo" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataBy1" UserSourceName="Artículo">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT     TIPDOC, IDDOC, GRUPO, FECHA, TIPOCONT, SERIE, NUMDOC, CLIPRO, NOMBRE, CODREP, CODALM, CODART, DESCLIN, UNIDADES, PRCMONEDA, DESC1, DESC2, DESC3, DESC4, BASE, PRCMEDIO
FROM            (
SELECT        'FV' AS TIPDOC, 'Vta.Credito' AS GRUPO, CABEFACV.IDFACV AS IDDOC, CABEFACV.FECHA, TIPOCONT, SERIE, NUMDOC, CODCLI CLIPRO, NOMCLI NOMBRE, LINEFACT.CODREP, LINEFACT.CODALM, LINEFACT.CODART, LINEFACT.DESCLIN, LINEFACT.UNIDADES, LINEFACT.PRCMONEDA, LINEFACT.DESC1, LINEFACT.DESC2, LINEFACT.DESC3, LINEFACT.DESC4, LINEFACT.BASE, LINEFACT.PRCMEDIO
FROM            CABEFACV INNER JOIN LINEFACT ON CABEFACV.IDFACV = LINEFACT.IDFACV
WHERE CONTABLE='F'
UNION ALL
SELECT       'AV' AS TIPDOC, CASE FACTURABLE WHEN 'T' THEN 'Vta.Credito' ELSE 'Contado' END AS GRUPO, CABEALBV.IDALBV AS IDDOC, CABEALBV.FECHA, TIPOCONT, SERIE, NUMDOC, CODCLI CLIPRO, NOMCLI NOMBRE, LINEALBA.CODREP, LINEALBA.CODALM, LINEALBA.CODART, LINEALBA.DESCLIN, LINEALBA.UNIDADES, LINEALBA.PRCMONEDA, LINEALBA.DESC1, LINEALBA.DESC2, LINEALBA.DESC3, LINEALBA.DESC4, LINEALBA.BASE, LINEALBA.PRCMEDIO
FROM            CABEALBV INNER JOIN LINEALBA ON CABEALBV.IDALBV = LINEALBA.IDALBV
WHERE CABEALBV.SITUACION='A'
UNION ALL
SELECT       'AC' AS TIPDOC, 'Compras' AS GRUPO, CABEALBC.IDALBC AS IDDOC, CABEALBC.FECHA, TIPOCONT, SERIE, NUMDOC, CODPRO CLIPRO, NOMPRO NOMBRE, LINEALBA.CODREP, LINEALBA.CODALM, LINEALBA.CODART, LINEALBA.DESCLIN, LINEALBA.UNIDADES, LINEALBA.PRCMONEDA, LINEALBA.DESC1, LINEALBA.DESC2, LINEALBA.DESC3, LINEALBA.DESC4, LINEALBA.BASE, LINEALBA.PRCMEDIO
FROM            CABEALBC INNER JOIN LINEALBA ON CABEALBC.IDALBC = LINEALBA.IDALBC
WHERE CABEALBC.SITUACION = 'A'
UNION ALL
SELECT       'FC' AS TIPDOC, 'Compras' AS GRUPO, CABEFACC.IDFACC AS IDDOC, CABEFACC.FECHA, TIPOCONT, SERIE, NUMDOC, CODPRO CLIPRO, NOMPRO NOMBRE, LINEFACT.CODREP, LINEFACT.CODALM, LINEFACT.CODART, LINEFACT.DESCLIN, LINEFACT.UNIDADES, LINEFACT.PRCMONEDA, LINEFACT.DESC1, LINEFACT.DESC2, LINEFACT.DESC3, LINEFACT.DESC4, LINEFACT.BASE, LINEFACT.PRCMEDIO
FROM            CABEFACC INNER JOIN LINEFACT ON CABEFACC.IDFACC = LINEFACT.IDFACC
WHERE CONTABLE = 'F'
) AS VENTAS
WHERE YEAR(FECHA) = @EJERCICIO AND MONTH(FECHA) = @MES AND CODART = @CODART AND (CODALM = @CODALM OR
                         @CODALM = '')</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="EJERCICIO" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="Decimal" Direction="Input" ParameterName="@EJERCICIO" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="MES" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="Decimal" Direction="Input" ParameterName="@MES" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODART" ColumnName="CODART" DataSourceName="SELECT 'FV' AS TIPDOC, 'Vta.Credito' AS GRUPO, CABEFACV.IDFACV AS IDDOC, CABEFACV.FECHA, TIPOCONT, SERIE, NUMDOC, CODCLI CLIPRO, NOMCLI NOMBRE, LINEFACT.CODREP, LINEFACT.CODALM, LINEFACT.CODART, LINEFACT.DESCLIN, LINEFACT.UNIDADES, LINEFACT.PRCMONEDA, LINEFACT.DESC1, LINEFACT.DESC2, LINEFACT.DESC3, LINEFACT.DESC4, LINEFACT.BASE, LINEFACT.PRCMEDIO FROM CABEFACV INNER JOIN LINEFACT ON CABEFACV.IDFACV = LINEFACT.IDFACV WHERE CONTABLE='F' UNION ALL SELECT 'AV' AS TIPDOC, CASE FACTURABLE WHEN 'T' THEN 'Vta.Credito' ELSE 'Contado' END AS GRUPO, CABEALBV.IDALBV AS IDDOC, CABEALBV.FECHA, TIPOCONT, SERIE, NUMDOC, CODCLI CLIPRO, NOMCLI NOMBRE, LINEALBA.CODREP, LINEALBA.CODALM, LINEALBA.CODART, LINEALBA.DESCLIN, LINEALBA.UNIDADES, LINEALBA.PRCMONEDA, LINEALBA.DESC1, LINEALBA.DESC2, LINEALBA.DESC3, LINEALBA.DESC4, LINEALBA.BASE, LINEALBA.PRCMEDIO FROM CABEALBV INNER JOIN LINEALBA ON CABEALBV.IDALBV = LINEALBA.IDALBV WHERE CABEALBV.SITUACION='A' UNION ALL SELECT 'AC' AS TIPDOC, 'Compras' AS GRUPO, CABEALBC.IDALBC AS IDDOC, CABEALBC.FECHA, TIPOCONT, SERIE, NUMDOC, CODPRO CLIPRO, NOMPRO NOMBRE, LINEALBA.CODREP, LINEALBA.CODALM, LINEALBA.CODART, LINEALBA.DESCLIN, LINEALBA.UNIDADES, LINEALBA.PRCMONEDA, LINEALBA.DESC1, LINEALBA.DESC2, LINEALBA.DESC3, LINEALBA.DESC4, LINEALBA.BASE, LINEALBA.PRCMEDIO FROM CABEALBC INNER JOIN LINEALBA ON CABEALBC.IDALBC = LINEALBA.IDALBC WHERE CABEALBC.SITUACION = 'A' UNION ALL SELECT 'FC' AS TIPDOC, 'Compras' AS GRUPO, CABEFACC.IDFACC AS IDDOC, CABEFACC.FECHA, TIPOCONT, SERIE, NUMDOC, CODPRO CLIPRO, NOMPRO NOMBRE, LINEFACT.CODREP, LINEFACT.CODALM, LINEFACT.CODART, LINEFACT.DESCLIN, LINEFACT.UNIDADES, LINEFACT.PRCMONEDA, LINEFACT.DESC1, LINEFACT.DESC2, LINEFACT.DESC3, LINEFACT.DESC4, LINEFACT.BASE, LINEFACT.PRCMEDIO FROM CABEFACC INNER JOIN LINEFACT ON CABEFACC.IDFACC = LINEFACT.IDFACC WHERE CONTABLE = 'F'" DataTypeServer="varchar(15)" DbType="AnsiString" Direction="Input" ParameterName="@CODART" Precision="0" Scale="0" Size="15" SourceColumn="CODART" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="CODALM" ColumnName="CODALM" DataSourceName="SELECT 'FV' AS TIPDOC, 'Vta.Credito' AS GRUPO, CABEFACV.IDFACV AS IDDOC, CABEFACV.FECHA, TIPOCONT, SERIE, NUMDOC, CODCLI CLIPRO, NOMCLI NOMBRE, LINEFACT.CODREP, LINEFACT.CODALM, LINEFACT.CODART, LINEFACT.DESCLIN, LINEFACT.UNIDADES, LINEFACT.PRCMONEDA, LINEFACT.DESC1, LINEFACT.DESC2, LINEFACT.DESC3, LINEFACT.DESC4, LINEFACT.BASE, LINEFACT.PRCMEDIO FROM CABEFACV INNER JOIN LINEFACT ON CABEFACV.IDFACV = LINEFACT.IDFACV WHERE CONTABLE='F' UNION ALL SELECT 'AV' AS TIPDOC, CASE FACTURABLE WHEN 'T' THEN 'Vta.Credito' ELSE 'Contado' END AS GRUPO, CABEALBV.IDALBV AS IDDOC, CABEALBV.FECHA, TIPOCONT, SERIE, NUMDOC, CODCLI CLIPRO, NOMCLI NOMBRE, LINEALBA.CODREP, LINEALBA.CODALM, LINEALBA.CODART, LINEALBA.DESCLIN, LINEALBA.UNIDADES, LINEALBA.PRCMONEDA, LINEALBA.DESC1, LINEALBA.DESC2, LINEALBA.DESC3, LINEALBA.DESC4, LINEALBA.BASE, LINEALBA.PRCMEDIO FROM CABEALBV INNER JOIN LINEALBA ON CABEALBV.IDALBV = LINEALBA.IDALBV WHERE CABEALBV.SITUACION='A' UNION ALL SELECT 'AC' AS TIPDOC, 'Compras' AS GRUPO, CABEALBC.IDALBC AS IDDOC, CABEALBC.FECHA, TIPOCONT, SERIE, NUMDOC, CODPRO CLIPRO, NOMPRO NOMBRE, LINEALBA.CODREP, LINEALBA.CODALM, LINEALBA.CODART, LINEALBA.DESCLIN, LINEALBA.UNIDADES, LINEALBA.PRCMONEDA, LINEALBA.DESC1, LINEALBA.DESC2, LINEALBA.DESC3, LINEALBA.DESC4, LINEALBA.BASE, LINEALBA.PRCMEDIO FROM CABEALBC INNER JOIN LINEALBA ON CABEALBC.IDALBC = LINEALBA.IDALBC WHERE CABEALBC.SITUACION = 'A' UNION ALL SELECT 'FC' AS TIPDOC, 'Compras' AS GRUPO, CABEFACC.IDFACC AS IDDOC, CABEFACC.FECHA, TIPOCONT, SERIE, NUMDOC, CODPRO CLIPRO, NOMPRO NOMBRE, LINEFACT.CODREP, LINEFACT.CODALM, LINEFACT.CODART, LINEFACT.DESCLIN, LINEFACT.UNIDADES, LINEFACT.PRCMONEDA, LINEFACT.DESC1, LINEFACT.DESC2, LINEFACT.DESC3, LINEFACT.DESC4, LINEFACT.BASE, LINEFACT.PRCMEDIO FROM CABEFACC INNER JOIN LINEFACT ON CABEFACC.IDFACC = LINEFACT.IDFACC WHERE CONTABLE = 'F'" DataTypeServer="varchar(8)" DbType="AnsiString" Direction="Input" ParameterName="@CODALM" Precision="0" Scale="0" Size="8" SourceColumn="CODALM" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="SqlConection (Settings)" DbObjectName="SELECT 'FV' AS TIPDOC, 'Vta.Credito' AS GRUPO, CABEFACV.IDFACV AS IDDOC, CABEFACV.FECHA, TIPOCONT, SERIE, NUMDOC, CODCLI CLIPRO, NOMCLI NOMBRE, LINEFACT.CODREP, LINEFACT.CODALM, LINEFACT.CODART, LINEFACT.DESCLIN, LINEFACT.UNIDADES, LINEFACT.PRCMONEDA, LINEFACT.DESC1, LINEFACT.DESC2, LINEFACT.DESC3, LINEFACT.DESC4, LINEFACT.BASE, LINEFACT.PRCMEDIO FROM CABEFACV INNER JOIN LINEFACT ON CABEFACV.IDFACV = LINEFACT.IDFACV WHERE CONTABLE='F' AND (LTRIM(CABEFACV.SERIE) &lt;&gt; '6') UNION ALL SELECT 'AV' AS TIPDOC, CASE FACTURABLE WHEN 'T' THEN 'Vta.Credito' ELSE 'Contado' END AS GRUPO, CABEALBV.IDALBV AS IDDOC, CABEALBV.FECHA, TIPOCONT, SERIE, NUMDOC, CODCLI CLIPRO, NOMCLI NOMBRE, LINEALBA.CODREP, LINEALBA.CODALM, LINEALBA.CODART, LINEALBA.DESCLIN, LINEALBA.UNIDADES, LINEALBA.PRCMONEDA, LINEALBA.DESC1, LINEALBA.DESC2, LINEALBA.DESC3, LINEALBA.DESC4, LINEALBA.BASE, LINEALBA.PRCMEDIO FROM CABEALBV INNER JOIN LINEALBA ON CABEALBV.IDALBV = LINEALBA.IDALBV WHERE LINEALBA.SITUACION='A' AND (LTRIM(CABEALBV.SERIE) &lt;&gt; '6') UNION ALL SELECT 'AC' AS TIPDOC, 'Compras' AS GRUPO, CABEALBC.IDALBC AS IDDOC, CABEALBC.FECHA, TIPOCONT, SERIE, NUMDOC, CODPRO CLIPRO, NOMPRO NOMBRE, LINEALBA.CODREP, LINEALBA.CODALM, LINEALBA.CODART, LINEALBA.DESCLIN, LINEALBA.UNIDADES, LINEALBA.PRCMONEDA, LINEALBA.DESC1, LINEALBA.DESC2, LINEALBA.DESC3, LINEALBA.DESC4, LINEALBA.BASE, LINEALBA.PRCMEDIO FROM CABEALBC INNER JOIN LINEALBA ON CABEALBC.IDALBC = LINEALBA.IDALBC WHERE CABEALBC.SITUACION = 'A' AND (LTRIM(CABEALBC.CODPRO) &lt;&gt; '911') UNION ALL SELECT 'FC' AS TIPDOC, 'Compras' AS GRUPO, CABEFACC.IDFACC AS IDDOC, CABEFACC.FECHA, TIPOCONT, SERIE, NUMDOC, CODPRO CLIPRO, NOMPRO NOMBRE, LINEFACT.CODREP, LINEFACT.CODALM, LINEFACT.CODART, LINEFACT.DESCLIN, LINEFACT.UNIDADES, LINEFACT.PRCMONEDA, LINEFACT.DESC1, LINEFACT.DESC2, LINEFACT.DESC3, LINEFACT.DESC4, LINEFACT.BASE, LINEFACT.PRCMEDIO FROM CABEFACC INNER JOIN LINEFACT ON CABEFACC.IDFACC = LINEFACT.IDFACC WHERE CONTABLE = 'F' AND (LTRIM(CABEFACC.CODPRO) &lt;&gt; '911')" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="ArtículoAMM" GenerateMethods="Fill" GenerateShortCommands="true" GeneratorSourceName="ArtículoAMM" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataBy2" UserSourceName="ArtículoAMM">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT     TIPDOC, IDDOC, GRUPO, FECHA, TIPOCONT, SERIE, NUMDOC, CLIPRO, NOMBRE, CODREP, CODALM, CODART, DESCLIN, UNIDADES, PRCMONEDA, DESC1, DESC2, DESC3, DESC4, BASE, PRCMEDIO
FROM            (
SELECT        'FV' AS TIPDOC, 'Vta.Credito' AS GRUPO, CABEFACV.IDFACV AS IDDOC, CABEFACV.FECHA, TIPOCONT, SERIE, NUMDOC, CODCLI CLIPRO, NOMCLI NOMBRE, LINEFACT.CODREP, LINEFACT.CODALM, LINEFACT.CODART, LINEFACT.DESCLIN, LINEFACT.UNIDADES, LINEFACT.PRCMONEDA, LINEFACT.DESC1, LINEFACT.DESC2, LINEFACT.DESC3, LINEFACT.DESC4, LINEFACT.BASE, LINEFACT.PRCMEDIO
FROM            CABEFACV INNER JOIN LINEFACT ON CABEFACV.IDFACV = LINEFACT.IDFACV
WHERE CONTABLE='F' AND (LTRIM(CABEFACV.SERIE) &lt;&gt; '6')
UNION ALL
SELECT       'AV' AS TIPDOC, CASE FACTURABLE WHEN 'T' THEN 'Vta.Credito' ELSE 'Contado' END AS GRUPO, CABEALBV.IDALBV AS IDDOC, CABEALBV.FECHA, TIPOCONT, SERIE, NUMDOC, CODCLI CLIPRO, NOMCLI NOMBRE, LINEALBA.CODREP, LINEALBA.CODALM, LINEALBA.CODART, LINEALBA.DESCLIN, LINEALBA.UNIDADES, LINEALBA.PRCMONEDA, LINEALBA.DESC1, LINEALBA.DESC2, LINEALBA.DESC3, LINEALBA.DESC4, LINEALBA.BASE, LINEALBA.PRCMEDIO
FROM            CABEALBV INNER JOIN LINEALBA ON CABEALBV.IDALBV = LINEALBA.IDALBV
WHERE LINEALBA.SITUACION='A' AND (LTRIM(CABEALBV.SERIE) &lt;&gt; '6')
UNION ALL
SELECT      'AC' AS TIPDOC, 'Compras' AS GRUPO, CABEALBC.IDALBC AS IDDOC, CABEALBC.FECHA, TIPOCONT, SERIE, NUMDOC, CODPRO CLIPRO, NOMPRO NOMBRE, LINEALBA.CODREP, LINEALBA.CODALM, LINEALBA.CODART, LINEALBA.DESCLIN, LINEALBA.UNIDADES, LINEALBA.PRCMONEDA, LINEALBA.DESC1, LINEALBA.DESC2, LINEALBA.DESC3, LINEALBA.DESC4, LINEALBA.BASE, LINEALBA.PRCMEDIO
FROM            CABEALBC INNER JOIN LINEALBA ON CABEALBC.IDALBC = LINEALBA.IDALBC 
WHERE CABEALBC.SITUACION = 'A' AND (LTRIM(CABEALBC.CODPRO) &lt;&gt; '911')
UNION ALL
SELECT      'FC' AS TIPDOC, 'Compras' AS GRUPO, CABEFACC.IDFACC AS IDDOC, CABEFACC.FECHA, TIPOCONT, SERIE, NUMDOC, CODPRO CLIPRO, NOMPRO NOMBRE, LINEFACT.CODREP, LINEFACT.CODALM, LINEFACT.CODART, LINEFACT.DESCLIN, LINEFACT.UNIDADES, LINEFACT.PRCMONEDA, LINEFACT.DESC1, LINEFACT.DESC2, LINEFACT.DESC3, LINEFACT.DESC4, LINEFACT.BASE, LINEFACT.PRCMEDIO
FROM            CABEFACC INNER JOIN LINEFACT ON CABEFACC.IDFACC = LINEFACT.IDFACC 
WHERE CONTABLE = 'F' AND (LTRIM(CABEFACC.CODPRO) &lt;&gt; '911')
) AS VENTAS
WHERE YEAR(FECHA) = @EJERCICIO AND MONTH(FECHA) = @MES AND CODART = @CODART AND (CODALM = @CODALM OR
                         @CODALM = '')</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="EJERCICIO" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="Decimal" Direction="Input" ParameterName="@EJERCICIO" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="MES" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="Decimal" Direction="Input" ParameterName="@MES" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODART" ColumnName="CODART" DataSourceName="SELECT 'FV' AS TIPDOC, 'Vta.Credito' AS GRUPO, CABEFACV.IDFACV AS IDDOC, CABEFACV.FECHA, TIPOCONT, SERIE, NUMDOC, CODCLI CLIPRO, NOMCLI NOMBRE, LINEFACT.CODREP, LINEFACT.CODALM, LINEFACT.CODART, LINEFACT.DESCLIN, LINEFACT.UNIDADES, LINEFACT.PRCMONEDA, LINEFACT.DESC1, LINEFACT.DESC2, LINEFACT.DESC3, LINEFACT.DESC4, LINEFACT.BASE, LINEFACT.PRCMEDIO FROM CABEFACV INNER JOIN LINEFACT ON CABEFACV.IDFACV = LINEFACT.IDFACV WHERE CONTABLE='F' AND (LTRIM(CABEFACV.SERIE) &lt;&gt; '6') UNION ALL SELECT 'AV' AS TIPDOC, CASE FACTURABLE WHEN 'T' THEN 'Vta.Credito' ELSE 'Contado' END AS GRUPO, CABEALBV.IDALBV AS IDDOC, CABEALBV.FECHA, TIPOCONT, SERIE, NUMDOC, CODCLI CLIPRO, NOMCLI NOMBRE, LINEALBA.CODREP, LINEALBA.CODALM, LINEALBA.CODART, LINEALBA.DESCLIN, LINEALBA.UNIDADES, LINEALBA.PRCMONEDA, LINEALBA.DESC1, LINEALBA.DESC2, LINEALBA.DESC3, LINEALBA.DESC4, LINEALBA.BASE, LINEALBA.PRCMEDIO FROM CABEALBV INNER JOIN LINEALBA ON CABEALBV.IDALBV = LINEALBA.IDALBV WHERE LINEALBA.SITUACION='A' AND (LTRIM(CABEALBV.SERIE) &lt;&gt; '6') UNION ALL SELECT 'AC' AS TIPDOC, 'Compras' AS GRUPO, CABEALBC.IDALBC AS IDDOC, CABEALBC.FECHA, TIPOCONT, SERIE, NUMDOC, CODPRO CLIPRO, NOMPRO NOMBRE, LINEALBA.CODREP, LINEALBA.CODALM, LINEALBA.CODART, LINEALBA.DESCLIN, LINEALBA.UNIDADES, LINEALBA.PRCMONEDA, LINEALBA.DESC1, LINEALBA.DESC2, LINEALBA.DESC3, LINEALBA.DESC4, LINEALBA.BASE, LINEALBA.PRCMEDIO FROM CABEALBC INNER JOIN LINEALBA ON CABEALBC.IDALBC = LINEALBA.IDALBC WHERE CABEALBC.SITUACION = 'A' AND (LTRIM(CABEALBC.CODPRO) &lt;&gt; '911') UNION ALL SELECT 'FC' AS TIPDOC, 'Compras' AS GRUPO, CABEFACC.IDFACC AS IDDOC, CABEFACC.FECHA, TIPOCONT, SERIE, NUMDOC, CODPRO CLIPRO, NOMPRO NOMBRE, LINEFACT.CODREP, LINEFACT.CODALM, LINEFACT.CODART, LINEFACT.DESCLIN, LINEFACT.UNIDADES, LINEFACT.PRCMONEDA, LINEFACT.DESC1, LINEFACT.DESC2, LINEFACT.DESC3, LINEFACT.DESC4, LINEFACT.BASE, LINEFACT.PRCMEDIO FROM CABEFACC INNER JOIN LINEFACT ON CABEFACC.IDFACC = LINEFACT.IDFACC WHERE CONTABLE = 'F' AND (LTRIM(CABEFACC.CODPRO) &lt;&gt; '911')" DataTypeServer="varchar(15)" DbType="AnsiString" Direction="Input" ParameterName="@CODART" Precision="0" Scale="0" Size="15" SourceColumn="CODART" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="CODALM" ColumnName="CODALM" DataSourceName="SELECT 'FV' AS TIPDOC, 'Vta.Credito' AS GRUPO, CABEFACV.IDFACV AS IDDOC, CABEFACV.FECHA, TIPOCONT, SERIE, NUMDOC, CODCLI CLIPRO, NOMCLI NOMBRE, LINEFACT.CODREP, LINEFACT.CODALM, LINEFACT.CODART, LINEFACT.DESCLIN, LINEFACT.UNIDADES, LINEFACT.PRCMONEDA, LINEFACT.DESC1, LINEFACT.DESC2, LINEFACT.DESC3, LINEFACT.DESC4, LINEFACT.BASE, LINEFACT.PRCMEDIO FROM CABEFACV INNER JOIN LINEFACT ON CABEFACV.IDFACV = LINEFACT.IDFACV WHERE CONTABLE='F' AND (LTRIM(CABEFACV.SERIE) &lt;&gt; '6') UNION ALL SELECT 'AV' AS TIPDOC, CASE FACTURABLE WHEN 'T' THEN 'Vta.Credito' ELSE 'Contado' END AS GRUPO, CABEALBV.IDALBV AS IDDOC, CABEALBV.FECHA, TIPOCONT, SERIE, NUMDOC, CODCLI CLIPRO, NOMCLI NOMBRE, LINEALBA.CODREP, LINEALBA.CODALM, LINEALBA.CODART, LINEALBA.DESCLIN, LINEALBA.UNIDADES, LINEALBA.PRCMONEDA, LINEALBA.DESC1, LINEALBA.DESC2, LINEALBA.DESC3, LINEALBA.DESC4, LINEALBA.BASE, LINEALBA.PRCMEDIO FROM CABEALBV INNER JOIN LINEALBA ON CABEALBV.IDALBV = LINEALBA.IDALBV WHERE LINEALBA.SITUACION='A' AND (LTRIM(CABEALBV.SERIE) &lt;&gt; '6') UNION ALL SELECT 'AC' AS TIPDOC, 'Compras' AS GRUPO, CABEALBC.IDALBC AS IDDOC, CABEALBC.FECHA, TIPOCONT, SERIE, NUMDOC, CODPRO CLIPRO, NOMPRO NOMBRE, LINEALBA.CODREP, LINEALBA.CODALM, LINEALBA.CODART, LINEALBA.DESCLIN, LINEALBA.UNIDADES, LINEALBA.PRCMONEDA, LINEALBA.DESC1, LINEALBA.DESC2, LINEALBA.DESC3, LINEALBA.DESC4, LINEALBA.BASE, LINEALBA.PRCMEDIO FROM CABEALBC INNER JOIN LINEALBA ON CABEALBC.IDALBC = LINEALBA.IDALBC WHERE CABEALBC.SITUACION = 'A' AND (LTRIM(CABEALBC.CODPRO) &lt;&gt; '911') UNION ALL SELECT 'FC' AS TIPDOC, 'Compras' AS GRUPO, CABEFACC.IDFACC AS IDDOC, CABEFACC.FECHA, TIPOCONT, SERIE, NUMDOC, CODPRO CLIPRO, NOMPRO NOMBRE, LINEFACT.CODREP, LINEFACT.CODALM, LINEFACT.CODART, LINEFACT.DESCLIN, LINEFACT.UNIDADES, LINEFACT.PRCMONEDA, LINEFACT.DESC1, LINEFACT.DESC2, LINEFACT.DESC3, LINEFACT.DESC4, LINEFACT.BASE, LINEFACT.PRCMEDIO FROM CABEFACC INNER JOIN LINEFACT ON CABEFACC.IDFACC = LINEFACT.IDFACC WHERE CONTABLE = 'F' AND (LTRIM(CABEFACC.CODPRO) &lt;&gt; '911')" DataTypeServer="varchar(8)" DbType="AnsiString" Direction="Input" ParameterName="@CODALM" Precision="0" Scale="0" Size="8" SourceColumn="CODALM" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="SqlConection (Settings)" DbObjectName="SELECT 'FV' AS TIPDOC, 'Vta.Credito' AS GRUPO, CABEFACV.IDFACV AS IDDOC, CABEFACV.FECHA, TIPOCONT, SERIE, NUMDOC, CODCLI CLIPRO, NOMCLI NOMBRE, LINEFACT.CODREP, LINEFACT.CODALM, LINEFACT.CODART, LINEFACT.DESCLIN, LINEFACT.UNIDADES, LINEFACT.PRCMONEDA, LINEFACT.DESC1, LINEFACT.DESC2, LINEFACT.DESC3, LINEFACT.DESC4, LINEFACT.BASE, LINEFACT.PRCMEDIO FROM CABEFACV INNER JOIN LINEFACT ON CABEFACV.IDFACV = LINEFACT.IDFACV WHERE CONTABLE='F' UNION ALL SELECT 'AV' AS TIPDOC, CASE FACTURABLE WHEN 'T' THEN 'Vta.Credito' ELSE 'Contado' END AS GRUPO, CABEALBV.IDALBV AS IDDOC, CABEALBV.FECHA, TIPOCONT, SERIE, NUMDOC, CODCLI CLIPRO, NOMCLI NOMBRE, LINEALBA.CODREP, LINEALBA.CODALM, LINEALBA.CODART, LINEALBA.DESCLIN, LINEALBA.UNIDADES, LINEALBA.PRCMONEDA, LINEALBA.DESC1, LINEALBA.DESC2, LINEALBA.DESC3, LINEALBA.DESC4, LINEALBA.BASE, LINEALBA.PRCMEDIO FROM CABEALBV INNER JOIN LINEALBA ON CABEALBV.IDALBV = LINEALBA.IDALBV WHERE LINEALBA.SITUACION='A'" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Cliente" GenerateMethods="Fill" GenerateShortCommands="true" GeneratorSourceName="Cliente" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataBy3" UserSourceName="Cliente">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT     TIPDOC, IDDOC, GRUPO, FECHA, TIPOCONT, SERIE, NUMDOC, CLIPRO, NOMBRE, CODREP, CODALM, CODART, DESCLIN, UNIDADES, PRCMONEDA, DESC1, DESC2, DESC3, DESC4, BASE, PRCMEDIO
FROM            (
SELECT        'FV' AS TIPDOC, 'Vta.Credito' AS GRUPO, CABEFACV.IDFACV AS IDDOC, CABEFACV.FECHA, TIPOCONT, SERIE, NUMDOC, CODCLI CLIPRO, NOMCLI NOMBRE, LINEFACT.CODREP, LINEFACT.CODALM, LINEFACT.CODART, LINEFACT.DESCLIN, LINEFACT.UNIDADES, LINEFACT.PRCMONEDA, LINEFACT.DESC1, LINEFACT.DESC2, LINEFACT.DESC3, LINEFACT.DESC4, LINEFACT.BASE, LINEFACT.PRCMEDIO
FROM            CABEFACV INNER JOIN LINEFACT ON CABEFACV.IDFACV = LINEFACT.IDFACV
WHERE CONTABLE='F'
UNION ALL
SELECT       'AV' AS TIPDOC, CASE FACTURABLE WHEN 'T' THEN 'Vta.Credito' ELSE 'Contado' END AS GRUPO, CABEALBV.IDALBV AS IDDOC, CABEALBV.FECHA, TIPOCONT, SERIE, NUMDOC, CODCLI CLIPRO, NOMCLI NOMBRE, LINEALBA.CODREP, LINEALBA.CODALM, LINEALBA.CODART, LINEALBA.DESCLIN, LINEALBA.UNIDADES, LINEALBA.PRCMONEDA, LINEALBA.DESC1, LINEALBA.DESC2, LINEALBA.DESC3, LINEALBA.DESC4, LINEALBA.BASE, LINEALBA.PRCMEDIO
FROM            CABEALBV INNER JOIN LINEALBA ON CABEALBV.IDALBV = LINEALBA.IDALBV
WHERE LINEALBA.SITUACION='A'
) AS VENTAS
WHERE YEAR(FECHA) = @EJERCICIO AND MONTH(FECHA) = @MES AND CLIPRO = @CODCLI AND LTRIM(TIPOCONT) &lt;&gt; '2'</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="EJERCICIO" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="Decimal" Direction="Input" ParameterName="@EJERCICIO" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="MES" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="Decimal" Direction="Input" ParameterName="@MES" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODCLI" ColumnName="CLIPRO" DataSourceName="SELECT 'FV' AS TIPDOC, 'Vta.Credito' AS GRUPO, CABEFACV.IDFACV AS IDDOC, CABEFACV.FECHA, TIPOCONT, SERIE, NUMDOC, CODCLI CLIPRO, NOMCLI NOMBRE, LINEFACT.CODREP, LINEFACT.CODALM, LINEFACT.CODART, LINEFACT.DESCLIN, LINEFACT.UNIDADES, LINEFACT.PRCMONEDA, LINEFACT.DESC1, LINEFACT.DESC2, LINEFACT.DESC3, LINEFACT.DESC4, LINEFACT.BASE, LINEFACT.PRCMEDIO FROM CABEFACV INNER JOIN LINEFACT ON CABEFACV.IDFACV = LINEFACT.IDFACV WHERE CONTABLE='F' UNION ALL SELECT 'AV' AS TIPDOC, CASE FACTURABLE WHEN 'T' THEN 'Vta.Credito' ELSE 'Contado' END AS GRUPO, CABEALBV.IDALBV AS IDDOC, CABEALBV.FECHA, TIPOCONT, SERIE, NUMDOC, CODCLI CLIPRO, NOMCLI NOMBRE, LINEALBA.CODREP, LINEALBA.CODALM, LINEALBA.CODART, LINEALBA.DESCLIN, LINEALBA.UNIDADES, LINEALBA.PRCMONEDA, LINEALBA.DESC1, LINEALBA.DESC2, LINEALBA.DESC3, LINEALBA.DESC4, LINEALBA.BASE, LINEALBA.PRCMEDIO FROM CABEALBV INNER JOIN LINEALBA ON CABEALBV.IDALBV = LINEALBA.IDALBV WHERE LINEALBA.SITUACION='A'" DataTypeServer="varchar(8)" DbType="AnsiString" Direction="Input" ParameterName="@CODCLI" Precision="0" Scale="0" Size="8" SourceColumn="CLIPRO" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="SqlConection (Settings)" DbObjectName="SELECT 'FV' AS TIPDOC, 'Vta.Credito' AS GRUPO, CABEFACV.IDFACV AS IDDOC, CABEFACV.FECHA, CABEFACV.TIPOCONT, CABEFACV.SERIE, CABEFACV.NUMDOC, CABEFACV.CODCLI AS CLIPRO, CABEFACV.NOMCLI AS NOMBRE, LINEFACT.CODREP, LINEFACT.CODALM, LINEFACT.CODART, LINEFACT.DESCLIN, LINEFACT.UNIDADES, LINEFACT.PRCMONEDA, LINEFACT.DESC1, LINEFACT.DESC2, LINEFACT.DESC3, LINEFACT.DESC4, LINEFACT.BASE, LINEFACT.PRCMEDIO FROM CABEFACV INNER JOIN LINEFACT ON CABEFACV.IDFACV = LINEFACT.IDFACV WHERE (CABEFACV.CONTABLE = 'F') UNION ALL SELECT 'AV' AS TIPDOC, CASE FACTURABLE WHEN 'T' THEN 'Vta.Credito' ELSE 'Contado' END AS GRUPO, CABEALBV.IDALBV AS IDDOC, CABEALBV.FECHA, CABEALBV.TIPOCONT, CABEALBV.SERIE, CABEALBV.NUMDOC, CABEALBV.CODCLI AS CLIPRO, CABEALBV.NOMCLI AS NOMBRE, LINEALBA.CODREP, LINEALBA.CODALM, LINEALBA.CODART, LINEALBA.DESCLIN, LINEALBA.UNIDADES, LINEALBA.PRCMONEDA, LINEALBA.DESC1, LINEALBA.DESC2, LINEALBA.DESC3, LINEALBA.DESC4, LINEALBA.BASE, LINEALBA.PRCMEDIO FROM CABEALBV INNER JOIN LINEALBA ON CABEALBV.IDALBV = LINEALBA.IDALBV WHERE (CABEALBV.SITUACION = 'A') UNION ALL SELECT 'AC' AS TIPDOC, 'Compras' AS GRUPO, CABEALBC.IDALBC AS IDDOC, CABEALBC.FECHA, CABEALBC.TIPOCONT, CABEALBC.SERIE, CABEALBC.NUMDOC, CABEALBC.CODPRO AS CLIPRO, CABEALBC.NOMPRO AS NOMBRE, LINEALBA_1.CODREP, LINEALBA_1.CODALM, LINEALBA_1.CODART, LINEALBA_1.DESCLIN, LINEALBA_1.UNIDADES, LINEALBA_1.PRCMONEDA, LINEALBA_1.DESC1, LINEALBA_1.DESC2, LINEALBA_1.DESC3, LINEALBA_1.DESC4, LINEALBA_1.BASE, LINEALBA_1.PRCMEDIO FROM CABEALBC INNER JOIN LINEALBA AS LINEALBA_1 ON CABEALBC.IDALBC = LINEALBA_1.IDALBC WHERE (CABEALBC.SITUACION = 'A') UNION ALL SELECT 'FC' AS TIPDOC, 'Compras' AS GRUPO, CABEFACC.IDFACC AS IDDOC, CABEFACC.FECHA, CABEFACC.TIPOCONT, CABEFACC.SERIE, CABEFACC.NUMDOC, CABEFACC.CODPRO AS CLIPRO, CABEFACC.NOMPRO AS NOMBRE, LINEFACT_1.CODREP, LINEFACT_1.CODALM, LINEFACT_1.CODART, LINEFACT_1.DESCLIN, LINEFACT_1.UNIDADES, LINEFACT_1.PRCMONEDA, LINEFACT_1.DESC1, LINEFACT_1.DESC2, LINEFACT_1.DESC3, LINEFACT_1.DESC4, LINEFACT_1.BASE, LINEFACT_1.PRCMEDIO FROM CABEFACC INNER JOIN LINEFACT AS LINEFACT_1 ON CABEFACC.IDFACC = LINEFACT_1.IDFACC WHERE (CABEFACC.CONTABLE = 'F')" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Familia" GenerateMethods="Fill" GenerateShortCommands="true" GeneratorSourceName="Familia" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataBy4" UserSourceName="Familia">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        VENTAS.TIPDOC, VENTAS.IDDOC, VENTAS.GRUPO, VENTAS.FECHA, VENTAS.TIPOCONT, VENTAS.SERIE, VENTAS.NUMDOC, VENTAS.CLIPRO, VENTAS.NOMBRE, 
                         VENTAS.CODREP, VENTAS.CODALM, VENTAS.CODART, VENTAS.DESCLIN, VENTAS.UNIDADES, VENTAS.PRCMONEDA, VENTAS.DESC1, VENTAS.DESC2, 
                         VENTAS.DESC3, VENTAS.DESC4, VENTAS.BASE, VENTAS.PRCMEDIO
FROM            (SELECT        'FV' AS TIPDOC, 'Vta.Credito' AS GRUPO, CABEFACV.IDFACV AS IDDOC, CABEFACV.FECHA, CABEFACV.TIPOCONT, CABEFACV.SERIE, 
                                                    CABEFACV.NUMDOC, CABEFACV.CODCLI AS CLIPRO, CABEFACV.NOMCLI AS NOMBRE, LINEFACT.CODREP, LINEFACT.CODALM, LINEFACT.CODART, 
                                                    LINEFACT.DESCLIN, LINEFACT.UNIDADES, LINEFACT.PRCMONEDA, LINEFACT.DESC1, LINEFACT.DESC2, LINEFACT.DESC3, LINEFACT.DESC4, 
                                                    LINEFACT.BASE, LINEFACT.PRCMEDIO
                          FROM            CABEFACV INNER JOIN
                                                    LINEFACT ON CABEFACV.IDFACV = LINEFACT.IDFACV
                          WHERE        (CABEFACV.CONTABLE = 'F')
                          UNION ALL
                          SELECT        'AV' AS TIPDOC, CASE FACTURABLE WHEN 'T' THEN 'Vta.Credito' ELSE 'Contado' END AS GRUPO, CABEALBV.IDALBV AS IDDOC, CABEALBV.FECHA, 
                                                   CABEALBV.TIPOCONT, CABEALBV.SERIE, CABEALBV.NUMDOC, CABEALBV.CODCLI AS CLIPRO, CABEALBV.NOMCLI AS NOMBRE, LINEALBA.CODREP, 
                                                   LINEALBA.CODALM, LINEALBA.CODART, LINEALBA.DESCLIN, LINEALBA.UNIDADES, LINEALBA.PRCMONEDA, LINEALBA.DESC1, LINEALBA.DESC2, 
                                                   LINEALBA.DESC3, LINEALBA.DESC4, LINEALBA.BASE, LINEALBA.PRCMEDIO
                          FROM            CABEALBV INNER JOIN
                                                   LINEALBA ON CABEALBV.IDALBV = LINEALBA.IDALBV
                          WHERE        (CABEALBV.SITUACION = 'A')
                          UNION ALL
                          SELECT        'AC' AS TIPDOC, 'Compras' AS GRUPO, CABEALBC.IDALBC AS IDDOC, CABEALBC.FECHA, CABEALBC.TIPOCONT, CABEALBC.SERIE, 
                                                   CABEALBC.NUMDOC, CABEALBC.CODPRO AS CLIPRO, CABEALBC.NOMPRO AS NOMBRE, LINEALBA_1.CODREP, LINEALBA_1.CODALM, 
                                                   LINEALBA_1.CODART, LINEALBA_1.DESCLIN, LINEALBA_1.UNIDADES, LINEALBA_1.PRCMONEDA, LINEALBA_1.DESC1, LINEALBA_1.DESC2, 
                                                   LINEALBA_1.DESC3, LINEALBA_1.DESC4, LINEALBA_1.BASE, LINEALBA_1.PRCMEDIO
                          FROM            CABEALBC INNER JOIN
                                                   LINEALBA AS LINEALBA_1 ON CABEALBC.IDALBC = LINEALBA_1.IDALBC
                          WHERE        (CABEALBC.SITUACION = 'A')
                          UNION ALL
                          SELECT        'FC' AS TIPDOC, 'Compras' AS GRUPO, CABEFACC.IDFACC AS IDDOC, CABEFACC.FECHA, CABEFACC.TIPOCONT, CABEFACC.SERIE, CABEFACC.NUMDOC, 
                                                   CABEFACC.CODPRO AS CLIPRO, CABEFACC.NOMPRO AS NOMBRE, LINEFACT_1.CODREP, LINEFACT_1.CODALM, LINEFACT_1.CODART, 
                                                   LINEFACT_1.DESCLIN, LINEFACT_1.UNIDADES, LINEFACT_1.PRCMONEDA, LINEFACT_1.DESC1, LINEFACT_1.DESC2, LINEFACT_1.DESC3, 
                                                   LINEFACT_1.DESC4, LINEFACT_1.BASE, LINEFACT_1.PRCMEDIO
                          FROM            CABEFACC INNER JOIN
                                                   LINEFACT AS LINEFACT_1 ON CABEFACC.IDFACC = LINEFACT_1.IDFACC
                          WHERE        (CABEFACC.CONTABLE = 'F')) AS VENTAS INNER JOIN
                         ARTICULO ON ARTICULO.CODART = VENTAS.CODART INNER JOIN
                         FAMILIAS ON ARTICULO.CODFAMEST = FAMILIAS.CODFAM AND FAMILIAS.FICHERO = 'Estadis' LEFT OUTER JOIN
                         SIE_ESTRUCTURASFAMILIAARTICULO ON FAMILIAS.ID = SIE_ESTRUCTURASFAMILIAARTICULO.ID_FAMILIAHIJA LEFT OUTER JOIN
                         FAMILIAS AS FamiliaPadre ON FamiliaPadre.ID = SIE_ESTRUCTURASFAMILIAARTICULO.ID_FAMILIAPADRE
WHERE        (YEAR(VENTAS.FECHA) = @EJERCICIO) AND (MONTH(VENTAS.FECHA) = @MES) AND (VENTAS.CODALM = @CODALM) AND (FAMILIAS.CODFAM = @CODFAM) OR
                         (YEAR(VENTAS.FECHA) = @EJERCICIO) AND (MONTH(VENTAS.FECHA) = @MES) AND (VENTAS.CODALM = @CODALM) AND (FamiliaPadre.CODFAM = @CODFAM) OR
                         (YEAR(VENTAS.FECHA) = @EJERCICIO) AND (MONTH(VENTAS.FECHA) = @MES) AND (FAMILIAS.CODFAM = @CODFAM) AND (@CODALM = '') OR
                         (YEAR(VENTAS.FECHA) = @EJERCICIO) AND (MONTH(VENTAS.FECHA) = @MES) AND (FamiliaPadre.CODFAM = @CODFAM) AND (@CODALM = '')</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="EJERCICIO" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="Decimal" Direction="Input" ParameterName="@EJERCICIO" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="MES" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="Decimal" Direction="Input" ParameterName="@MES" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="CODALM" ColumnName="CODALM" DataSourceName="SELECT 'FV' AS TIPDOC, 'Vta.Credito' AS GRUPO, CABEFACV.IDFACV AS IDDOC, CABEFACV.FECHA, CABEFACV.TIPOCONT, CABEFACV.SERIE, CABEFACV.NUMDOC, CABEFACV.CODCLI AS CLIPRO, CABEFACV.NOMCLI AS NOMBRE, LINEFACT.CODREP, LINEFACT.CODALM, LINEFACT.CODART, LINEFACT.DESCLIN, LINEFACT.UNIDADES, LINEFACT.PRCMONEDA, LINEFACT.DESC1, LINEFACT.DESC2, LINEFACT.DESC3, LINEFACT.DESC4, LINEFACT.BASE, LINEFACT.PRCMEDIO FROM CABEFACV INNER JOIN LINEFACT ON CABEFACV.IDFACV = LINEFACT.IDFACV WHERE (CABEFACV.CONTABLE = 'F') UNION ALL SELECT 'AV' AS TIPDOC, CASE FACTURABLE WHEN 'T' THEN 'Vta.Credito' ELSE 'Contado' END AS GRUPO, CABEALBV.IDALBV AS IDDOC, CABEALBV.FECHA, CABEALBV.TIPOCONT, CABEALBV.SERIE, CABEALBV.NUMDOC, CABEALBV.CODCLI AS CLIPRO, CABEALBV.NOMCLI AS NOMBRE, LINEALBA.CODREP, LINEALBA.CODALM, LINEALBA.CODART, LINEALBA.DESCLIN, LINEALBA.UNIDADES, LINEALBA.PRCMONEDA, LINEALBA.DESC1, LINEALBA.DESC2, LINEALBA.DESC3, LINEALBA.DESC4, LINEALBA.BASE, LINEALBA.PRCMEDIO FROM CABEALBV INNER JOIN LINEALBA ON CABEALBV.IDALBV = LINEALBA.IDALBV WHERE (CABEALBV.SITUACION = 'A') UNION ALL SELECT 'AC' AS TIPDOC, 'Compras' AS GRUPO, CABEALBC.IDALBC AS IDDOC, CABEALBC.FECHA, CABEALBC.TIPOCONT, CABEALBC.SERIE, CABEALBC.NUMDOC, CABEALBC.CODPRO AS CLIPRO, CABEALBC.NOMPRO AS NOMBRE, LINEALBA_1.CODREP, LINEALBA_1.CODALM, LINEALBA_1.CODART, LINEALBA_1.DESCLIN, LINEALBA_1.UNIDADES, LINEALBA_1.PRCMONEDA, LINEALBA_1.DESC1, LINEALBA_1.DESC2, LINEALBA_1.DESC3, LINEALBA_1.DESC4, LINEALBA_1.BASE, LINEALBA_1.PRCMEDIO FROM CABEALBC INNER JOIN LINEALBA AS LINEALBA_1 ON CABEALBC.IDALBC = LINEALBA_1.IDALBC WHERE (CABEALBC.SITUACION = 'A') UNION ALL SELECT 'FC' AS TIPDOC, 'Compras' AS GRUPO, CABEFACC.IDFACC AS IDDOC, CABEFACC.FECHA, CABEFACC.TIPOCONT, CABEFACC.SERIE, CABEFACC.NUMDOC, CABEFACC.CODPRO AS CLIPRO, CABEFACC.NOMPRO AS NOMBRE, LINEFACT_1.CODREP, LINEFACT_1.CODALM, LINEFACT_1.CODART, LINEFACT_1.DESCLIN, LINEFACT_1.UNIDADES, LINEFACT_1.PRCMONEDA, LINEFACT_1.DESC1, LINEFACT_1.DESC2, LINEFACT_1.DESC3, LINEFACT_1.DESC4, LINEFACT_1.BASE, LINEFACT_1.PRCMEDIO FROM CABEFACC INNER JOIN LINEFACT AS LINEFACT_1 ON CABEFACC.IDFACC = LINEFACT_1.IDFACC WHERE (CABEFACC.CONTABLE = 'F')" DataTypeServer="varchar(8)" DbType="AnsiString" Direction="Input" ParameterName="@CODALM" Precision="0" Scale="0" Size="8" SourceColumn="CODALM" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODFAM" ColumnName="CODFAM" DataSourceName="BDMOLINA.dbo.FAMILIAS" DataTypeServer="varchar(8)" DbType="AnsiString" Direction="Input" ParameterName="@CODFAM" Precision="0" ProviderType="VarChar" Scale="0" Size="8" SourceColumn="CODFAM" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="SqlConection (Settings)" DbObjectName="SELECT 'FV' AS TIPDOC, 'Vta.Credito' AS GRUPO, CABEFACV.IDFACV AS IDDOC, CABEFACV.FECHA, CABEFACV.TIPOCONT, CABEFACV.SERIE, CABEFACV.NUMDOC, CABEFACV.CODCLI AS CLIPRO, CABEFACV.NOMCLI AS NOMBRE, LINEFACT.CODREP, LINEFACT.CODALM, LINEFACT.CODART, LINEFACT.DESCLIN, LINEFACT.UNIDADES, LINEFACT.PRCMONEDA, LINEFACT.DESC1, LINEFACT.DESC2, LINEFACT.DESC3, LINEFACT.DESC4, LINEFACT.BASE, LINEFACT.PRCMEDIO FROM CABEFACV INNER JOIN LINEFACT ON CABEFACV.IDFACV = LINEFACT.IDFACV WHERE (CABEFACV.CONTABLE = 'F') AND (LTRIM(CABEFACV.SERIE) &lt;&gt; '6') UNION ALL SELECT 'AV' AS TIPDOC, CASE FACTURABLE WHEN 'T' THEN 'Vta.Credito' ELSE 'Contado' END AS GRUPO, CABEALBV.IDALBV AS IDDOC, CABEALBV.FECHA, CABEALBV.TIPOCONT, CABEALBV.SERIE, CABEALBV.NUMDOC, CABEALBV.CODCLI AS CLIPRO, CABEALBV.NOMCLI AS NOMBRE, LINEALBA.CODREP, LINEALBA.CODALM, LINEALBA.CODART, LINEALBA.DESCLIN, LINEALBA.UNIDADES, LINEALBA.PRCMONEDA, LINEALBA.DESC1, LINEALBA.DESC2, LINEALBA.DESC3, LINEALBA.DESC4, LINEALBA.BASE, LINEALBA.PRCMEDIO FROM CABEALBV INNER JOIN LINEALBA ON CABEALBV.IDALBV = LINEALBA.IDALBV WHERE (LINEALBA.SITUACION = 'A') AND (LTRIM(CABEALBV.SERIE) &lt;&gt; '6') UNION ALL SELECT 'AC' AS TIPDOC, 'Compras' AS GRUPO, CABEALBC.IDALBC AS IDDOC, CABEALBC.FECHA, CABEALBC.TIPOCONT, CABEALBC.SERIE, CABEALBC.NUMDOC, CABEALBC.CODPRO AS CLIPRO, CABEALBC.NOMPRO AS NOMBRE, LINEALBA_1.CODREP, LINEALBA_1.CODALM, LINEALBA_1.CODART, LINEALBA_1.DESCLIN, LINEALBA_1.UNIDADES, LINEALBA_1.PRCMONEDA, LINEALBA_1.DESC1, LINEALBA_1.DESC2, LINEALBA_1.DESC3, LINEALBA_1.DESC4, LINEALBA_1.BASE, LINEALBA_1.PRCMEDIO FROM CABEALBC INNER JOIN LINEALBA AS LINEALBA_1 ON CABEALBC.IDALBC = LINEALBA_1.IDALBC WHERE (CABEALBC.SITUACION = 'A') AND (LTRIM(CABEALBC.CODPRO) &lt;&gt; '911') UNION ALL SELECT 'FC' AS TIPDOC, 'Compras' AS GRUPO, CABEFACC.IDFACC AS IDDOC, CABEFACC.FECHA, CABEFACC.TIPOCONT, CABEFACC.SERIE, CABEFACC.NUMDOC, CABEFACC.CODPRO AS CLIPRO, CABEFACC.NOMPRO AS NOMBRE, LINEFACT_1.CODREP, LINEFACT_1.CODALM, LINEFACT_1.CODART, LINEFACT_1.DESCLIN, LINEFACT_1.UNIDADES, LINEFACT_1.PRCMONEDA, LINEFACT_1.DESC1, LINEFACT_1.DESC2, LINEFACT_1.DESC3, LINEFACT_1.DESC4, LINEFACT_1.BASE, LINEFACT_1.PRCMEDIO FROM CABEFACC INNER JOIN LINEFACT AS LINEFACT_1 ON CABEFACC.IDFACC = LINEFACT_1.IDFACC WHERE (CABEFACC.CONTABLE = 'F') AND (LTRIM(CABEFACC.CODPRO) &lt;&gt; '911')" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="FamiliaAMM" GenerateMethods="Fill" GenerateShortCommands="true" GeneratorSourceName="FamiliaAMM" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataBy5" UserSourceName="FamiliaAMM">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT        VENTAS.TIPDOC, VENTAS.IDDOC, VENTAS.GRUPO, VENTAS.FECHA, VENTAS.TIPOCONT, VENTAS.SERIE, VENTAS.NUMDOC, VENTAS.CLIPRO, VENTAS.NOMBRE, 
                         VENTAS.CODREP, VENTAS.CODALM, VENTAS.CODART, VENTAS.DESCLIN, VENTAS.UNIDADES, VENTAS.PRCMONEDA, VENTAS.DESC1, VENTAS.DESC2, 
                         VENTAS.DESC3, VENTAS.DESC4, VENTAS.BASE, VENTAS.PRCMEDIO
FROM            (SELECT        'FV' AS TIPDOC, 'Vta.Credito' AS GRUPO, CABEFACV.IDFACV AS IDDOC, CABEFACV.FECHA, CABEFACV.TIPOCONT, CABEFACV.SERIE, 
                                                    CABEFACV.NUMDOC, CABEFACV.CODCLI AS CLIPRO, CABEFACV.NOMCLI AS NOMBRE, LINEFACT.CODREP, LINEFACT.CODALM, LINEFACT.CODART, 
                                                    LINEFACT.DESCLIN, LINEFACT.UNIDADES, LINEFACT.PRCMONEDA, LINEFACT.DESC1, LINEFACT.DESC2, LINEFACT.DESC3, LINEFACT.DESC4, 
                                                    LINEFACT.BASE, LINEFACT.PRCMEDIO
                          FROM            CABEFACV INNER JOIN
                                                    LINEFACT ON CABEFACV.IDFACV = LINEFACT.IDFACV
                          WHERE        (CABEFACV.CONTABLE = 'F') AND (LTRIM(CABEFACV.SERIE) &lt;&gt; '6')
                          UNION ALL
                          SELECT        'AV' AS TIPDOC, CASE FACTURABLE WHEN 'T' THEN 'Vta.Credito' ELSE 'Contado' END AS GRUPO, CABEALBV.IDALBV AS IDDOC, CABEALBV.FECHA, 
                                                   CABEALBV.TIPOCONT, CABEALBV.SERIE, CABEALBV.NUMDOC, CABEALBV.CODCLI AS CLIPRO, CABEALBV.NOMCLI AS NOMBRE, LINEALBA.CODREP, 
                                                   LINEALBA.CODALM, LINEALBA.CODART, LINEALBA.DESCLIN, LINEALBA.UNIDADES, LINEALBA.PRCMONEDA, LINEALBA.DESC1, LINEALBA.DESC2, 
                                                   LINEALBA.DESC3, LINEALBA.DESC4, LINEALBA.BASE, LINEALBA.PRCMEDIO
                          FROM            CABEALBV INNER JOIN
                                                   LINEALBA ON CABEALBV.IDALBV = LINEALBA.IDALBV
                          WHERE        (LINEALBA.SITUACION = 'A') AND (LTRIM(CABEALBV.SERIE) &lt;&gt; '6')
                          UNION ALL
                          SELECT        'AC' AS TIPDOC, 'Compras' AS GRUPO, CABEALBC.IDALBC AS IDDOC, CABEALBC.FECHA, CABEALBC.TIPOCONT, CABEALBC.SERIE, 
                                                   CABEALBC.NUMDOC, CABEALBC.CODPRO AS CLIPRO, CABEALBC.NOMPRO AS NOMBRE, LINEALBA_1.CODREP, LINEALBA_1.CODALM, 
                                                   LINEALBA_1.CODART, LINEALBA_1.DESCLIN, LINEALBA_1.UNIDADES, LINEALBA_1.PRCMONEDA, LINEALBA_1.DESC1, LINEALBA_1.DESC2, 
                                                   LINEALBA_1.DESC3, LINEALBA_1.DESC4, LINEALBA_1.BASE, LINEALBA_1.PRCMEDIO
                          FROM            CABEALBC INNER JOIN
                                                   LINEALBA AS LINEALBA_1 ON CABEALBC.IDALBC = LINEALBA_1.IDALBC
                          WHERE        (CABEALBC.SITUACION = 'A') AND (LTRIM(CABEALBC.CODPRO) &lt;&gt; '911')
                          UNION ALL
                          SELECT        'FC' AS TIPDOC, 'Compras' AS GRUPO, CABEFACC.IDFACC AS IDDOC, CABEFACC.FECHA, CABEFACC.TIPOCONT, CABEFACC.SERIE, CABEFACC.NUMDOC, 
                                                   CABEFACC.CODPRO AS CLIPRO, CABEFACC.NOMPRO AS NOMBRE, LINEFACT_1.CODREP, LINEFACT_1.CODALM, LINEFACT_1.CODART, 
                                                   LINEFACT_1.DESCLIN, LINEFACT_1.UNIDADES, LINEFACT_1.PRCMONEDA, LINEFACT_1.DESC1, LINEFACT_1.DESC2, LINEFACT_1.DESC3, 
                                                   LINEFACT_1.DESC4, LINEFACT_1.BASE, LINEFACT_1.PRCMEDIO
                          FROM            CABEFACC INNER JOIN
                                                   LINEFACT AS LINEFACT_1 ON CABEFACC.IDFACC = LINEFACT_1.IDFACC
                          WHERE        (CABEFACC.CONTABLE = 'F') AND (LTRIM(CABEFACC.CODPRO) &lt;&gt; '911')) AS VENTAS INNER JOIN
                         ARTICULO ON ARTICULO.CODART = VENTAS.CODART INNER JOIN
                         FAMILIAS ON ARTICULO.CODFAMEST = FAMILIAS.CODFAM AND FAMILIAS.FICHERO = 'Estadis' LEFT OUTER JOIN
                         SIE_ESTRUCTURASFAMILIAARTICULO ON FAMILIAS.ID = SIE_ESTRUCTURASFAMILIAARTICULO.ID_FAMILIAHIJA LEFT OUTER JOIN
                         FAMILIAS AS FamiliaPadre ON FamiliaPadre.ID = SIE_ESTRUCTURASFAMILIAARTICULO.ID_FAMILIAPADRE
WHERE        (YEAR(VENTAS.FECHA) = @EJERCICIO) AND (MONTH(VENTAS.FECHA) = @MES) AND (VENTAS.CODALM = @CODALM) AND (FAMILIAS.CODFAM = @CODFAM) OR
                         (YEAR(VENTAS.FECHA) = @EJERCICIO) AND (MONTH(VENTAS.FECHA) = @MES) AND (VENTAS.CODALM = @CODALM) AND (FamiliaPadre.CODFAM = @CODFAM) OR
                         (YEAR(VENTAS.FECHA) = @EJERCICIO) AND (MONTH(VENTAS.FECHA) = @MES) AND (FAMILIAS.CODFAM = @CODFAM) AND (@CODALM = '') OR
                         (YEAR(VENTAS.FECHA) = @EJERCICIO) AND (MONTH(VENTAS.FECHA) = @MES) AND (FamiliaPadre.CODFAM = @CODFAM) AND (@CODALM = '')</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="EJERCICIO" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="Decimal" Direction="Input" ParameterName="@EJERCICIO" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="MES" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="Decimal" Direction="Input" ParameterName="@MES" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="CODALM" ColumnName="CODALM" DataSourceName="SELECT 'FV' AS TIPDOC, 'Vta.Credito' AS GRUPO, CABEFACV.IDFACV AS IDDOC, CABEFACV.FECHA, CABEFACV.TIPOCONT, CABEFACV.SERIE, CABEFACV.NUMDOC, CABEFACV.CODCLI AS CLIPRO, CABEFACV.NOMCLI AS NOMBRE, LINEFACT.CODREP, LINEFACT.CODALM, LINEFACT.CODART, LINEFACT.DESCLIN, LINEFACT.UNIDADES, LINEFACT.PRCMONEDA, LINEFACT.DESC1, LINEFACT.DESC2, LINEFACT.DESC3, LINEFACT.DESC4, LINEFACT.BASE, LINEFACT.PRCMEDIO FROM CABEFACV INNER JOIN LINEFACT ON CABEFACV.IDFACV = LINEFACT.IDFACV WHERE (CABEFACV.CONTABLE = 'F') AND (LTRIM(CABEFACV.SERIE) &lt;&gt; '6') UNION ALL SELECT 'AV' AS TIPDOC, CASE FACTURABLE WHEN 'T' THEN 'Vta.Credito' ELSE 'Contado' END AS GRUPO, CABEALBV.IDALBV AS IDDOC, CABEALBV.FECHA, CABEALBV.TIPOCONT, CABEALBV.SERIE, CABEALBV.NUMDOC, CABEALBV.CODCLI AS CLIPRO, CABEALBV.NOMCLI AS NOMBRE, LINEALBA.CODREP, LINEALBA.CODALM, LINEALBA.CODART, LINEALBA.DESCLIN, LINEALBA.UNIDADES, LINEALBA.PRCMONEDA, LINEALBA.DESC1, LINEALBA.DESC2, LINEALBA.DESC3, LINEALBA.DESC4, LINEALBA.BASE, LINEALBA.PRCMEDIO FROM CABEALBV INNER JOIN LINEALBA ON CABEALBV.IDALBV = LINEALBA.IDALBV WHERE (LINEALBA.SITUACION = 'A') AND (LTRIM(CABEALBV.SERIE) &lt;&gt; '6') UNION ALL SELECT 'AC' AS TIPDOC, 'Compras' AS GRUPO, CABEALBC.IDALBC AS IDDOC, CABEALBC.FECHA, CABEALBC.TIPOCONT, CABEALBC.SERIE, CABEALBC.NUMDOC, CABEALBC.CODPRO AS CLIPRO, CABEALBC.NOMPRO AS NOMBRE, LINEALBA_1.CODREP, LINEALBA_1.CODALM, LINEALBA_1.CODART, LINEALBA_1.DESCLIN, LINEALBA_1.UNIDADES, LINEALBA_1.PRCMONEDA, LINEALBA_1.DESC1, LINEALBA_1.DESC2, LINEALBA_1.DESC3, LINEALBA_1.DESC4, LINEALBA_1.BASE, LINEALBA_1.PRCMEDIO FROM CABEALBC INNER JOIN LINEALBA AS LINEALBA_1 ON CABEALBC.IDALBC = LINEALBA_1.IDALBC WHERE (CABEALBC.SITUACION = 'A') AND (LTRIM(CABEALBC.CODPRO) &lt;&gt; '911') UNION ALL SELECT 'FC' AS TIPDOC, 'Compras' AS GRUPO, CABEFACC.IDFACC AS IDDOC, CABEFACC.FECHA, CABEFACC.TIPOCONT, CABEFACC.SERIE, CABEFACC.NUMDOC, CABEFACC.CODPRO AS CLIPRO, CABEFACC.NOMPRO AS NOMBRE, LINEFACT_1.CODREP, LINEFACT_1.CODALM, LINEFACT_1.CODART, LINEFACT_1.DESCLIN, LINEFACT_1.UNIDADES, LINEFACT_1.PRCMONEDA, LINEFACT_1.DESC1, LINEFACT_1.DESC2, LINEFACT_1.DESC3, LINEFACT_1.DESC4, LINEFACT_1.BASE, LINEFACT_1.PRCMEDIO FROM CABEFACC INNER JOIN LINEFACT AS LINEFACT_1 ON CABEFACC.IDFACC = LINEFACT_1.IDFACC WHERE (CABEFACC.CONTABLE = 'F') AND (LTRIM(CABEFACC.CODPRO) &lt;&gt; '911')" DataTypeServer="varchar(8)" DbType="AnsiString" Direction="Input" ParameterName="@CODALM" Precision="0" Scale="0" Size="8" SourceColumn="CODALM" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODFAM" ColumnName="CODFAM" DataSourceName="BDMOLINA.dbo.FAMILIAS" DataTypeServer="varchar(8)" DbType="AnsiString" Direction="Input" ParameterName="@CODFAM" Precision="0" ProviderType="VarChar" Scale="0" Size="8" SourceColumn="CODFAM" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="SqlConection (Settings)" DbObjectName="SELECT 'AC' AS TIPDOC, CABEALBC.IDALBC AS IDDOC, CABEALBC.CODPRO, CABEALBC.FECHA, TIPOCONT, SERIE, NUMDOC, CODPRO CLIPRO, NOMPRO NOMBRE, LINEALBA.CODREP, LINEALBA.CODALM, LINEALBA.CODART, LINEALBA.DESCLIN, LINEALBA.UNIDADES, LINEALBA.PRCMONEDA, LINEALBA.DESC1, LINEALBA.DESC2, LINEALBA.DESC3, LINEALBA.DESC4, LINEALBA.BASE, LINEALBA.PRCMEDIO FROM CABEALBC INNER JOIN LINEALBA ON CABEALBC.IDALBC = LINEALBA.IDALBC WHERE CABEALBC.SITUACION = 'A' UNION ALL SELECT 'FC' AS TIPDOC, CABEFACC.IDFACC AS IDDOC, CABEFACC.CODPRO, CABEFACC.FECHA, TIPOCONT, SERIE, NUMDOC, CODPRO CLIPRO, NOMPRO NOMBRE, LINEFACT.CODREP, LINEFACT.CODALM, LINEFACT.CODART, LINEFACT.DESCLIN, LINEFACT.UNIDADES, LINEFACT.PRCMONEDA, LINEFACT.DESC1, LINEFACT.DESC2, LINEFACT.DESC3, LINEFACT.DESC4, LINEFACT.BASE, LINEFACT.PRCMEDIO FROM CABEFACC INNER JOIN LINEFACT ON CABEFACC.IDFACC = LINEFACT.IDFACC WHERE CONTABLE = 'F'" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Proveedor" GenerateMethods="Fill" GenerateShortCommands="true" GeneratorSourceName="Proveedor" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataBy6" UserSourceName="Proveedor">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT       TIPDOC, 'Compras' AS GRUPO, IDDOC, FECHA, TIPOCONT, SERIE, NUMDOC, CODPRO CLIPRO, NOMBRE, CODREP, CODALM, CODART, DESCLIN, UNIDADES, PRCMONEDA, DESC1, DESC2, DESC3, DESC4, BASE, PRCMEDIO
FROM (
SELECT       'AC' AS TIPDOC, CABEALBC.IDALBC AS IDDOC, CABEALBC.CODPRO, CABEALBC.FECHA, TIPOCONT, SERIE, NUMDOC, CODPRO CLIPRO, NOMPRO NOMBRE, LINEALBA.CODREP, LINEALBA.CODALM, LINEALBA.CODART, LINEALBA.DESCLIN, LINEALBA.UNIDADES, LINEALBA.PRCMONEDA, LINEALBA.DESC1, LINEALBA.DESC2, LINEALBA.DESC3, LINEALBA.DESC4, LINEALBA.BASE, LINEALBA.PRCMEDIO
FROM            CABEALBC INNER JOIN LINEALBA ON CABEALBC.IDALBC = LINEALBA.IDALBC
WHERE CABEALBC.SITUACION = 'A'
UNION ALL
SELECT       'FC' AS TIPDOC, CABEFACC.IDFACC AS IDDOC, CABEFACC.CODPRO, CABEFACC.FECHA, TIPOCONT, SERIE, NUMDOC, CODPRO CLIPRO, NOMPRO NOMBRE, LINEFACT.CODREP, LINEFACT.CODALM, LINEFACT.CODART, LINEFACT.DESCLIN, LINEFACT.UNIDADES, LINEFACT.PRCMONEDA, LINEFACT.DESC1, LINEFACT.DESC2, LINEFACT.DESC3, LINEFACT.DESC4, LINEFACT.BASE, LINEFACT.PRCMEDIO
FROM            CABEFACC INNER JOIN LINEFACT ON CABEFACC.IDFACC = LINEFACT.IDFACC
WHERE CONTABLE = 'F'
) AS COMPRAS
WHERE YEAR(FECHA) = @EJERCICIO AND MONTH(FECHA) = @MES AND CODPRO = @CODPRO</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="EJERCICIO" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="Decimal" Direction="Input" ParameterName="@EJERCICIO" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="MES" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="Decimal" Direction="Input" ParameterName="@MES" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="CODPRO" ColumnName="CODPRO" DataSourceName="SELECT 'AC' AS TIPDOC, CABEALBC.IDALBC AS IDDOC, CABEALBC.CODPRO, CABEALBC.FECHA, TIPOCONT, SERIE, NUMDOC, CODPRO CLIPRO, NOMPRO NOMBRE, LINEALBA.CODREP, LINEALBA.CODALM, LINEALBA.CODART, LINEALBA.DESCLIN, LINEALBA.UNIDADES, LINEALBA.PRCMONEDA, LINEALBA.DESC1, LINEALBA.DESC2, LINEALBA.DESC3, LINEALBA.DESC4, LINEALBA.BASE, LINEALBA.PRCMEDIO FROM CABEALBC INNER JOIN LINEALBA ON CABEALBC.IDALBC = LINEALBA.IDALBC WHERE CABEALBC.SITUACION = 'A' UNION ALL SELECT 'FC' AS TIPDOC, CABEFACC.IDFACC AS IDDOC, CABEFACC.CODPRO, CABEFACC.FECHA, TIPOCONT, SERIE, NUMDOC, CODPRO CLIPRO, NOMPRO NOMBRE, LINEFACT.CODREP, LINEFACT.CODALM, LINEFACT.CODART, LINEFACT.DESCLIN, LINEFACT.UNIDADES, LINEFACT.PRCMONEDA, LINEFACT.DESC1, LINEFACT.DESC2, LINEFACT.DESC3, LINEFACT.DESC4, LINEFACT.BASE, LINEFACT.PRCMEDIO FROM CABEFACC INNER JOIN LINEFACT ON CABEFACC.IDFACC = LINEFACT.IDFACC WHERE CONTABLE = 'F'" DataTypeServer="varchar(8)" DbType="AnsiString" Direction="Input" ParameterName="@CODPRO" Precision="0" Scale="0" Size="8" SourceColumn="CLIPRO" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="SqlConection (Settings)" DbObjectName="SELECT 'FV' AS TIPDOC, 'Vta.Credito' AS GRUPO, CABEFACV.IDFACV AS IDDOC, CABEFACV.FECHA, TIPOCONT, SERIE, NUMDOC, CODCLI CLIPRO, NOMCLI NOMBRE, LINEFACT.CODREP, LINEFACT.CODALM, LINEFACT.CODART, LINEFACT.DESCLIN, LINEFACT.UNIDADES, LINEFACT.PRCMONEDA, LINEFACT.DESC1, LINEFACT.DESC2, LINEFACT.DESC3, LINEFACT.DESC4, LINEFACT.BASE, LINEFACT.PRCMEDIO FROM CABEFACV INNER JOIN LINEFACT ON CABEFACV.IDFACV = LINEFACT.IDFACV WHERE CONTABLE='F' UNION ALL SELECT 'AV' AS TIPDOC, CASE FACTURABLE WHEN 'T' THEN 'Vta.Credito' ELSE 'Contado' END AS GRUPO, CABEALBV.IDALBV AS IDDOC, CABEALBV.FECHA, TIPOCONT, SERIE, NUMDOC, CODCLI CLIPRO, NOMCLI NOMBRE, LINEALBA.CODREP, LINEALBA.CODALM, LINEALBA.CODART, LINEALBA.DESCLIN, LINEALBA.UNIDADES, LINEALBA.PRCMONEDA, LINEALBA.DESC1, LINEALBA.DESC2, LINEALBA.DESC3, LINEALBA.DESC4, LINEALBA.BASE, LINEALBA.PRCMEDIO FROM CABEALBV INNER JOIN LINEALBA ON CABEALBV.IDALBV = LINEALBA.IDALBV WHERE LINEALBA.SITUACION='A'" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Representante" GenerateMethods="Fill" GenerateShortCommands="true" GeneratorSourceName="Representante" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataBy7" UserSourceName="Representante">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT     TIPDOC, IDDOC, GRUPO, FECHA, TIPOCONT, SERIE, NUMDOC, CLIPRO, NOMBRE, CODREP, CODALM, CODART, DESCLIN, UNIDADES, PRCMONEDA, DESC1, DESC2, DESC3, DESC4, BASE, PRCMEDIO
FROM            (
SELECT        'FV' AS TIPDOC, 'Vta.Credito' AS GRUPO, CABEFACV.IDFACV AS IDDOC, CABEFACV.FECHA, TIPOCONT, SERIE, NUMDOC, CODCLI CLIPRO, NOMCLI NOMBRE, LINEFACT.CODREP, LINEFACT.CODALM, LINEFACT.CODART, LINEFACT.DESCLIN, LINEFACT.UNIDADES, LINEFACT.PRCMONEDA, LINEFACT.DESC1, LINEFACT.DESC2, LINEFACT.DESC3, LINEFACT.DESC4, LINEFACT.BASE, LINEFACT.PRCMEDIO
FROM            CABEFACV INNER JOIN LINEFACT ON CABEFACV.IDFACV = LINEFACT.IDFACV
WHERE CONTABLE='F'
UNION ALL
SELECT       'AV' AS TIPDOC, CASE FACTURABLE WHEN 'T' THEN 'Vta.Credito' ELSE 'Contado' END AS GRUPO, CABEALBV.IDALBV AS IDDOC, CABEALBV.FECHA, TIPOCONT, SERIE, NUMDOC, CODCLI CLIPRO, NOMCLI NOMBRE, LINEALBA.CODREP, LINEALBA.CODALM, LINEALBA.CODART, LINEALBA.DESCLIN, LINEALBA.UNIDADES, LINEALBA.PRCMONEDA, LINEALBA.DESC1, LINEALBA.DESC2, LINEALBA.DESC3, LINEALBA.DESC4, LINEALBA.BASE, LINEALBA.PRCMEDIO
FROM            CABEALBV INNER JOIN LINEALBA ON CABEALBV.IDALBV = LINEALBA.IDALBV
WHERE LINEALBA.SITUACION='A'
) AS VENTAS
WHERE YEAR(FECHA) = @EJERCICIO AND MONTH(FECHA) = @MES AND CODREP = @CODREP</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="EJERCICIO" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="Decimal" Direction="Input" ParameterName="@EJERCICIO" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="MES" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="Decimal" Direction="Input" ParameterName="@MES" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="CODREP" ColumnName="CODREP" DataSourceName="SELECT 'FV' AS TIPDOC, 'Vta.Credito' AS GRUPO, CABEFACV.IDFACV AS IDDOC, CABEFACV.FECHA, TIPOCONT, SERIE, NUMDOC, CODCLI CLIPRO, NOMCLI NOMBRE, LINEFACT.CODREP, LINEFACT.CODALM, LINEFACT.CODART, LINEFACT.DESCLIN, LINEFACT.UNIDADES, LINEFACT.PRCMONEDA, LINEFACT.DESC1, LINEFACT.DESC2, LINEFACT.DESC3, LINEFACT.DESC4, LINEFACT.BASE, LINEFACT.PRCMEDIO FROM CABEFACV INNER JOIN LINEFACT ON CABEFACV.IDFACV = LINEFACT.IDFACV WHERE CONTABLE='F' UNION ALL SELECT 'AV' AS TIPDOC, CASE FACTURABLE WHEN 'T' THEN 'Vta.Credito' ELSE 'Contado' END AS GRUPO, CABEALBV.IDALBV AS IDDOC, CABEALBV.FECHA, TIPOCONT, SERIE, NUMDOC, CODCLI CLIPRO, NOMCLI NOMBRE, LINEALBA.CODREP, LINEALBA.CODALM, LINEALBA.CODART, LINEALBA.DESCLIN, LINEALBA.UNIDADES, LINEALBA.PRCMONEDA, LINEALBA.DESC1, LINEALBA.DESC2, LINEALBA.DESC3, LINEALBA.DESC4, LINEALBA.BASE, LINEALBA.PRCMEDIO FROM CABEALBV INNER JOIN LINEALBA ON CABEALBV.IDALBV = LINEALBA.IDALBV WHERE LINEALBA.SITUACION='A'" DataTypeServer="varchar(8)" DbType="AnsiString" Direction="Input" ParameterName="@CODREP" Precision="0" Scale="0" Size="8" SourceColumn="CODREP" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
              <DbSource ConnectionRef="SqlConection (Settings)" DbObjectName="SELECT 'FV' AS TIPDOC, 'Vta.Credito' AS GRUPO, CABEFACV.IDFACV AS IDDOC, CABEFACV.FECHA, TIPOCONT, SERIE, NUMDOC, CODCLI CLIPRO, NOMCLI NOMBRE, LINEFACT.CODREP, LINEFACT.CODALM, LINEFACT.CODART, LINEFACT.DESCLIN, LINEFACT.UNIDADES, LINEFACT.PRCMONEDA, LINEFACT.DESC1, LINEFACT.DESC2, LINEFACT.DESC3, LINEFACT.DESC4, LINEFACT.BASE, LINEFACT.PRCMEDIO FROM CABEFACV INNER JOIN LINEFACT ON CABEFACV.IDFACV = LINEFACT.IDFACV WHERE CONTABLE='F' UNION ALL SELECT 'AV' AS TIPDOC, CASE FACTURABLE WHEN 'T' THEN 'Vta.Credito' ELSE 'Contado' END AS GRUPO, CABEALBV.IDALBV AS IDDOC, CABEALBV.FECHA, TIPOCONT, SERIE, NUMDOC, CODCLI CLIPRO, NOMCLI NOMBRE, LINEALBA.CODREP, LINEALBA.CODALM, LINEALBA.CODART, LINEALBA.DESCLIN, LINEALBA.UNIDADES, LINEALBA.PRCMONEDA, LINEALBA.DESC1, LINEALBA.DESC2, LINEALBA.DESC3, LINEALBA.DESC4, LINEALBA.BASE, LINEALBA.PRCMEDIO FROM CABEALBV INNER JOIN LINEALBA ON CABEALBV.IDALBV = LINEALBA.IDALBV WHERE LINEALBA.SITUACION='A'" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Ruta" GenerateMethods="Fill" GenerateShortCommands="true" GeneratorSourceName="Ruta" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="true" UserGetMethodName="GetDataBy8" UserSourceName="Ruta">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>SELECT     TIPDOC, IDDOC, GRUPO, FECHA, TIPOCONT, SERIE, NUMDOC, CLIPRO, NOMBRE, VENTAS.CODREP, VENTAS.CODALM, CODART, DESCLIN, UNIDADES, PRCMONEDA, VENTAS.DESC1, VENTAS.DESC2, VENTAS.DESC3, VENTAS.DESC4, BASE, PRCMEDIO
FROM            (
SELECT        'FV' AS TIPDOC, 'Vta.Credito' AS GRUPO, CABEFACV.IDFACV AS IDDOC, CABEFACV.FECHA, TIPOCONT, SERIE, NUMDOC, CODCLI CLIPRO, NOMCLI NOMBRE, LINEFACT.CODREP, LINEFACT.CODALM, LINEFACT.CODART, LINEFACT.DESCLIN, LINEFACT.UNIDADES, LINEFACT.PRCMONEDA, LINEFACT.DESC1, LINEFACT.DESC2, LINEFACT.DESC3, LINEFACT.DESC4, LINEFACT.BASE, LINEFACT.PRCMEDIO
FROM            CABEFACV INNER JOIN LINEFACT ON CABEFACV.IDFACV = LINEFACT.IDFACV
WHERE CONTABLE='F'
UNION ALL
SELECT       'AV' AS TIPDOC, CASE FACTURABLE WHEN 'T' THEN 'Vta.Credito' ELSE 'Contado' END AS GRUPO, CABEALBV.IDALBV AS IDDOC, CABEALBV.FECHA, TIPOCONT, SERIE, NUMDOC, CODCLI CLIPRO, NOMCLI NOMBRE, LINEALBA.CODREP, LINEALBA.CODALM, LINEALBA.CODART, LINEALBA.DESCLIN, LINEALBA.UNIDADES, LINEALBA.PRCMONEDA, LINEALBA.DESC1, LINEALBA.DESC2, LINEALBA.DESC3, LINEALBA.DESC4, LINEALBA.BASE, LINEALBA.PRCMEDIO
FROM            CABEALBV INNER JOIN LINEALBA ON CABEALBV.IDALBV = LINEALBA.IDALBV
WHERE LINEALBA.SITUACION='A'
) AS VENTAS
LEFT JOIN CLIENTES ON CLIENTES.CODCLI = VENTAS.CLIPRO
WHERE YEAR(FECHA) = @EJERCICIO AND MONTH(FECHA) = @MES AND CLIENTES.RUTA = @RUTA</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="EJERCICIO" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="Decimal" Direction="Input" ParameterName="@EJERCICIO" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="false" AutogeneratedName="MES" ColumnName="" DataSourceName="" DataTypeServer="unknown" DbType="Decimal" Direction="Input" ParameterName="@MES" Precision="0" Scale="0" Size="0" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                      <Parameter AllowDbNull="true" AutogeneratedName="RUTA" ColumnName="RUTA" DataSourceName="BDMOLINA.dbo.CLIENTES" DataTypeServer="varchar(8)" DbType="AnsiString" Direction="Input" ParameterName="@RUTA" Precision="0" ProviderType="VarChar" Scale="0" Size="8" SourceColumn="RUTA" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </Sources>
          </TableAdapter>
        </Tables>
        <Sources />
      </DataSource>
    </xs:appinfo>
  </xs:annotation>
  <xs:element name="dsEstadisticas" msdata:IsDataSet="true" msdata:UseCurrentLocale="true" msprop:EnableTableAdapterManager="true" msprop:Generator_DataSetName="dsEstadisticas" msprop:Generator_UserDSName="dsEstadisticas">
    <xs:complexType>
      <xs:choice minOccurs="0" maxOccurs="unbounded">
        <xs:element name="VENTAS" msprop:Generator_TableClassName="VENTASDataTable" msprop:Generator_TableVarName="tableVENTAS" msprop:Generator_TablePropName="VENTAS" msprop:Generator_RowDeletingName="VENTASRowDeleting" msprop:Generator_RowChangingName="VENTASRowChanging" msprop:Generator_RowEvHandlerName="VENTASRowChangeEventHandler" msprop:Generator_RowDeletedName="VENTASRowDeleted" msprop:Generator_UserTableName="VENTAS" msprop:Generator_RowChangedName="VENTASRowChanged" msprop:Generator_RowEvArgName="VENTASRowChangeEvent" msprop:Generator_RowClassName="VENTASRow">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="EJERCICIO" msdata:ReadOnly="true" msdata:Caption="Ejercicio" msprop:Generator_ColumnVarNameInTable="columnEJERCICIO" msprop:Generator_ColumnPropNameInRow="EJERCICIO" msprop:Generator_ColumnPropNameInTable="EJERCICIOColumn" msprop:Generator_UserColumnName="EJERCICIO" type="xs:int" minOccurs="0" />
              <xs:element name="MES" msdata:ReadOnly="true" msdata:Caption="Mes" msprop:Generator_ColumnVarNameInTable="columnMES" msprop:Generator_ColumnPropNameInRow="MES" msprop:Generator_ColumnPropNameInTable="MESColumn" msprop:Generator_UserColumnName="MES" type="xs:int" minOccurs="0" />
              <xs:element name="VENTA_CONTADO" msdata:ReadOnly="true" msdata:Caption="Vta.Contado" msprop:Generator_ColumnVarNameInTable="columnVENTA_CONTADO" msprop:Generator_ColumnPropNameInRow="VENTA_CONTADO" msprop:Generator_ColumnPropNameInTable="VENTA_CONTADOColumn" msprop:Generator_UserColumnName="VENTA_CONTADO" type="xs:decimal" minOccurs="0" />
              <xs:element name="VENTA_CREDITO" msdata:ReadOnly="true" msdata:Caption="Vta.Crédito" msprop:Generator_ColumnVarNameInTable="columnVENTA_CREDITO" msprop:Generator_ColumnPropNameInRow="VENTA_CREDITO" msprop:Generator_ColumnPropNameInTable="VENTA_CREDITOColumn" msprop:Generator_UserColumnName="VENTA_CREDITO" type="xs:decimal" minOccurs="0" />
              <xs:element name="COSTE_CONTADO" msdata:ReadOnly="true" msdata:Caption="Coste contado" msprop:Generator_ColumnVarNameInTable="columnCOSTE_CONTADO" msprop:Generator_ColumnPropNameInRow="COSTE_CONTADO" msprop:Generator_ColumnPropNameInTable="COSTE_CONTADOColumn" msprop:Generator_UserColumnName="COSTE_CONTADO" type="xs:double" minOccurs="0" />
              <xs:element name="COSTE_CREDITO" msdata:ReadOnly="true" msdata:Caption="Coste crédito" msprop:Generator_ColumnVarNameInTable="columnCOSTE_CREDITO" msprop:Generator_ColumnPropNameInRow="COSTE_CREDITO" msprop:Generator_ColumnPropNameInTable="COSTE_CREDITOColumn" msprop:Generator_UserColumnName="COSTE_CREDITO" type="xs:double" minOccurs="0" />
              <xs:element name="VENTA_TOTAL" msdata:ReadOnly="true" msdata:Expression="VENTA_CONTADO + VENTA_CREDITO" msdata:Caption="Vta.Total" msprop:Generator_ColumnVarNameInTable="columnVENTA_TOTAL" msprop:Generator_ColumnPropNameInRow="VENTA_TOTAL" msprop:Generator_ColumnPropNameInTable="VENTA_TOTALColumn" msprop:Generator_UserColumnName="VENTA_TOTAL" type="xs:double" minOccurs="0" />
              <xs:element name="COSTE_TOTAL" msdata:ReadOnly="true" msdata:Expression="COSTE_CONTADO + COSTE_CREDITO" msdata:Caption="Coste total" msprop:Generator_ColumnVarNameInTable="columnCOSTE_TOTAL" msprop:Generator_ColumnPropNameInRow="COSTE_TOTAL" msprop:Generator_ColumnPropNameInTable="COSTE_TOTALColumn" msprop:Generator_UserColumnName="COSTE_TOTAL" type="xs:double" minOccurs="0" />
              <xs:element name="RENT_CONTADO" msdata:Caption="Rent.Contado" msprop:Generator_ColumnVarNameInTable="columnRENT_CONTADO" msprop:Generator_ColumnPropNameInRow="RENT_CONTADO" msprop:Generator_ColumnPropNameInTable="RENT_CONTADOColumn" msprop:Generator_UserColumnName="RENT_CONTADO" type="xs:double" minOccurs="0" />
              <xs:element name="RENT_CREDITO" msdata:Caption="Rent.Crédito" msprop:Generator_ColumnVarNameInTable="columnRENT_CREDITO" msprop:Generator_ColumnPropNameInRow="RENT_CREDITO" msprop:Generator_ColumnPropNameInTable="RENT_CREDITOColumn" msprop:Generator_UserColumnName="RENT_CREDITO" type="xs:double" minOccurs="0" />
              <xs:element name="RENT_TOTAL" msdata:Caption="Rent.Total" msprop:Generator_ColumnVarNameInTable="columnRENT_TOTAL" msprop:Generator_ColumnPropNameInRow="RENT_TOTAL" msprop:Generator_ColumnPropNameInTable="RENT_TOTALColumn" msprop:Generator_UserColumnName="RENT_TOTAL" type="xs:double" minOccurs="0" />
              <xs:element name="COMPRA" msdata:Caption="Compra" msprop:Generator_ColumnVarNameInTable="columnCOMPRA" msprop:Generator_ColumnPropNameInRow="COMPRA" msprop:Generator_ColumnPropNameInTable="COMPRAColumn" msprop:Generator_UserColumnName="COMPRA" type="xs:double" minOccurs="0" />
              <xs:element name="UNI_CONTADO" msdata:Caption="Uni.Contado" msprop:Generator_ColumnVarNameInTable="columnUNI_CONTADO" msprop:Generator_ColumnPropNameInRow="UNI_CONTADO" msprop:Generator_ColumnPropNameInTable="UNI_CONTADOColumn" msprop:Generator_UserColumnName="UNI_CONTADO" type="xs:double" minOccurs="0" />
              <xs:element name="UNI_CREDITO" msdata:Caption="Uni.Crédito" msprop:Generator_ColumnVarNameInTable="columnUNI_CREDITO" msprop:Generator_ColumnPropNameInRow="UNI_CREDITO" msprop:Generator_ColumnPropNameInTable="UNI_CREDITOColumn" msprop:Generator_UserColumnName="UNI_CREDITO" type="xs:double" minOccurs="0" />
              <xs:element name="UNIDADES" msdata:ReadOnly="true" msdata:Expression="UNI_CONTADO + UNI_CREDITO" msdata:Caption="Uni.Total" msprop:Generator_ColumnVarNameInTable="columnUNIDADES" msprop:Generator_ColumnPropNameInRow="UNIDADES" msprop:Generator_ColumnPropNameInTable="UNIDADESColumn" msprop:Generator_UserColumnName="UNIDADES" type="xs:double" minOccurs="0" />
              <xs:element name="NOMBRE_MES" msdata:Caption="Mes" msprop:Generator_ColumnVarNameInTable="columnNOMBRE_MES" msprop:Generator_ColumnPropNameInRow="NOMBRE_MES" msprop:Generator_ColumnPropNameInTable="NOMBRE_MESColumn" msprop:Generator_UserColumnName="NOMBRE_MES" type="xs:string" minOccurs="0" />
              <xs:element name="UNI_COMPRA" msprop:Generator_ColumnVarNameInTable="columnUNI_COMPRA" msprop:Generator_ColumnPropNameInRow="UNI_COMPRA" msprop:Generator_ColumnPropNameInTable="UNI_COMPRAColumn" msprop:Generator_UserColumnName="UNI_COMPRA" type="xs:double" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="DETALLE_VENTAS" msprop:Generator_TableClassName="DETALLE_VENTASDataTable" msprop:Generator_TableVarName="tableDETALLE_VENTAS" msprop:Generator_TablePropName="DETALLE_VENTAS" msprop:Generator_RowDeletingName="DETALLE_VENTASRowDeleting" msprop:Generator_RowChangingName="DETALLE_VENTASRowChanging" msprop:Generator_RowEvHandlerName="DETALLE_VENTASRowChangeEventHandler" msprop:Generator_RowDeletedName="DETALLE_VENTASRowDeleted" msprop:Generator_UserTableName="DETALLE_VENTAS" msprop:Generator_RowChangedName="DETALLE_VENTASRowChanged" msprop:Generator_RowEvArgName="DETALLE_VENTASRowChangeEvent" msprop:Generator_RowClassName="DETALLE_VENTASRow">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="TIPDOC" msdata:ReadOnly="true" msdata:Caption="Origen" msprop:Generator_ColumnVarNameInTable="columnTIPDOC" msprop:Generator_ColumnPropNameInRow="TIPDOC" msprop:Generator_ColumnPropNameInTable="TIPDOCColumn" msprop:Generator_UserColumnName="TIPDOC" type="xs:string" minOccurs="0" />
              <xs:element name="IDDOC" msdata:ReadOnly="true" msprop:Generator_ColumnVarNameInTable="columnIDDOC" msprop:Generator_ColumnPropNameInRow="IDDOC" msprop:Generator_ColumnPropNameInTable="IDDOCColumn" msprop:Generator_UserColumnName="IDDOC" type="xs:decimal" minOccurs="0" />
              <xs:element name="FECHA" msdata:ReadOnly="true" msdata:Caption="Fecha" msprop:Generator_ColumnVarNameInTable="columnFECHA" msprop:Generator_ColumnPropNameInRow="FECHA" msprop:Generator_ColumnPropNameInTable="FECHAColumn" msprop:Generator_UserColumnName="FECHA" type="xs:dateTime" minOccurs="0" />
              <xs:element name="TIPOCONT" msdata:ReadOnly="true" msdata:Caption="Tipo contable" msprop:Generator_ColumnVarNameInTable="columnTIPOCONT" msprop:Generator_ColumnPropNameInRow="TIPOCONT" msprop:Generator_ColumnPropNameInTable="TIPOCONTColumn" msprop:Generator_UserColumnName="TIPOCONT" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="3" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="SERIE" msdata:ReadOnly="true" msdata:Caption="Serie" msprop:Generator_ColumnVarNameInTable="columnSERIE" msprop:Generator_ColumnPropNameInRow="SERIE" msprop:Generator_ColumnPropNameInTable="SERIEColumn" msprop:Generator_UserColumnName="SERIE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="8" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NUMDOC" msdata:ReadOnly="true" msdata:Caption="NºDocumento" msprop:Generator_ColumnVarNameInTable="columnNUMDOC" msprop:Generator_ColumnPropNameInRow="NUMDOC" msprop:Generator_ColumnPropNameInTable="NUMDOCColumn" msprop:Generator_UserColumnName="NUMDOC" type="xs:decimal" minOccurs="0" />
              <xs:element name="CLIPRO" msdata:ReadOnly="true" msdata:Caption="Cliente/Proveedor" msprop:Generator_ColumnVarNameInTable="columnCLIPRO" msprop:Generator_ColumnPropNameInRow="CLIPRO" msprop:Generator_ColumnPropNameInTable="CLIPROColumn" msprop:Generator_UserColumnName="CLIPRO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="8" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="NOMBRE" msdata:ReadOnly="true" msdata:Caption="Nombre" msprop:Generator_ColumnVarNameInTable="columnNOMBRE" msprop:Generator_ColumnPropNameInRow="NOMBRE" msprop:Generator_ColumnPropNameInTable="NOMBREColumn" msprop:Generator_UserColumnName="NOMBRE" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODREP" msdata:ReadOnly="true" msdata:Caption="Representante" msprop:Generator_ColumnVarNameInTable="columnCODREP" msprop:Generator_ColumnPropNameInRow="CODREP" msprop:Generator_ColumnPropNameInTable="CODREPColumn" msprop:Generator_UserColumnName="CODREP" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="8" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODALM" msdata:ReadOnly="true" msdata:Caption="Almacén" msprop:Generator_ColumnVarNameInTable="columnCODALM" msprop:Generator_ColumnPropNameInRow="CODALM" msprop:Generator_ColumnPropNameInTable="CODALMColumn" msprop:Generator_UserColumnName="CODALM" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="8" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="CODART" msdata:ReadOnly="true" msdata:Caption="Artículo" msprop:Generator_ColumnVarNameInTable="columnCODART" msprop:Generator_ColumnPropNameInRow="CODART" msprop:Generator_ColumnPropNameInTable="CODARTColumn" msprop:Generator_UserColumnName="CODART" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="15" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="DESCLIN" msdata:ReadOnly="true" msdata:Caption="Descripción" msprop:Generator_ColumnVarNameInTable="columnDESCLIN" msprop:Generator_ColumnPropNameInRow="DESCLIN" msprop:Generator_ColumnPropNameInTable="DESCLINColumn" msprop:Generator_UserColumnName="DESCLIN" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="100" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="UNIDADES" msdata:ReadOnly="true" msdata:Caption="Unidades" msprop:Generator_ColumnVarNameInTable="columnUNIDADES" msprop:Generator_ColumnPropNameInRow="UNIDADES" msprop:Generator_ColumnPropNameInTable="UNIDADESColumn" msprop:Generator_UserColumnName="UNIDADES" type="xs:double" minOccurs="0" />
              <xs:element name="PRCMONEDA" msdata:ReadOnly="true" msdata:Caption="Precio" msprop:Generator_ColumnVarNameInTable="columnPRCMONEDA" msprop:Generator_ColumnPropNameInRow="PRCMONEDA" msprop:Generator_ColumnPropNameInTable="PRCMONEDAColumn" msprop:Generator_UserColumnName="PRCMONEDA" type="xs:double" minOccurs="0" />
              <xs:element name="DESC1" msdata:ReadOnly="true" msdata:Caption="Dto.1" msprop:Generator_ColumnVarNameInTable="columnDESC1" msprop:Generator_ColumnPropNameInRow="DESC1" msprop:Generator_ColumnPropNameInTable="DESC1Column" msprop:Generator_UserColumnName="DESC1" type="xs:decimal" minOccurs="0" />
              <xs:element name="DESC2" msdata:ReadOnly="true" msdata:Caption="Dto.2" msprop:Generator_ColumnVarNameInTable="columnDESC2" msprop:Generator_ColumnPropNameInRow="DESC2" msprop:Generator_ColumnPropNameInTable="DESC2Column" msprop:Generator_UserColumnName="DESC2" type="xs:decimal" minOccurs="0" />
              <xs:element name="DESC3" msdata:ReadOnly="true" msdata:Caption="Dto.3" msprop:Generator_ColumnVarNameInTable="columnDESC3" msprop:Generator_ColumnPropNameInRow="DESC3" msprop:Generator_ColumnPropNameInTable="DESC3Column" msprop:Generator_UserColumnName="DESC3" type="xs:decimal" minOccurs="0" />
              <xs:element name="DESC4" msdata:ReadOnly="true" msdata:Caption="Dto.4" msprop:Generator_ColumnVarNameInTable="columnDESC4" msprop:Generator_ColumnPropNameInRow="DESC4" msprop:Generator_ColumnPropNameInTable="DESC4Column" msprop:Generator_UserColumnName="DESC4" type="xs:decimal" minOccurs="0" />
              <xs:element name="BASE" msdata:ReadOnly="true" msdata:Caption="Total" msprop:Generator_ColumnVarNameInTable="columnBASE" msprop:Generator_ColumnPropNameInRow="BASE" msprop:Generator_ColumnPropNameInTable="BASEColumn" msprop:Generator_UserColumnName="BASE" type="xs:decimal" minOccurs="0" />
              <xs:element name="PRCMEDIO" msdata:ReadOnly="true" msdata:Caption="Coste" msprop:Generator_ColumnVarNameInTable="columnPRCMEDIO" msprop:Generator_ColumnPropNameInRow="PRCMEDIO" msprop:Generator_ColumnPropNameInTable="PRCMEDIOColumn" msprop:Generator_UserColumnName="PRCMEDIO" type="xs:double" minOccurs="0" />
              <xs:element name="GRUPO" msdata:ReadOnly="true" msdata:Caption="Tipo" msprop:Generator_ColumnVarNameInTable="columnGRUPO" msprop:Generator_ColumnPropNameInRow="GRUPO" msprop:Generator_ColumnPropNameInTable="GRUPOColumn" msprop:Generator_UserColumnName="GRUPO" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="11" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
            </xs:sequence>
          </xs:complexType>
        </xs:element>
      </xs:choice>
    </xs:complexType>
  </xs:element>
</xs:schema>